# Chapter 17. ìƒ¤ë”© ê´€ë¦¬

- ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¬ë‹¤.

## 1. í˜„ì¬ ìƒíƒœ í™•ì¸

---

- ë°ì´í„°ì˜ ìœ„ì¹˜, ìƒ¤ë“œ êµ¬ì„±, í´ëŸ¬ìŠ¤í„° ì‹¤í–‰ ì‘ì—…ì„ ì¡°íšŒí•  ìˆ˜ ìˆëŠ” ëª‡ ê°€ì§€ ë³´ì¡°ìê°€ ìˆë‹¤.

### 1-1. `sh.status()`ë¥¼ ì‚¬ìš©í•´ ìš”ì•½ ì •ë³´ ì–»ê¸°

---

- `sh.status()`ëŠ” ìƒ¤ë“œ, ë°ì´í„°ë² ì´ìŠ¤, ìƒ¤ë”©ëœ ì»¬ë ‰ì…˜ì˜ ê°œìš”ë¥¼ ì œê³µí•œë‹¤.
    - ì²­í¬ì˜ ê°œìˆ˜ê°€ ì ë‹¤ë©´ ì–´ëŠ ì²­í¬ê°€ ì–´ë””ì— ìœ„ì¹˜í•˜ëŠ”ì§€ë„ ì¶œë ¥í•œë‹¤.
    - ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ë‹¨ìˆœíˆ ì»¬ë ‰ì…˜ì˜ ìƒ¤ë“œ í‚¤ì™€ ê° ìƒ¤ë“œê°€ ê°–ëŠ” ì²­í¬ ê°œìˆ˜ë¥¼ ë³´ê³ í•œë‹¤.

```bash
> sh.status()
--- Sharding Status ---
  sharding version: {
   "_id" : <num>,
   "minCompatibleVersion" : <num>,
   "currentVersion" : <num>,
   "clusterId" : <ObjectId>
}
shards:
 { "_id" : <shard name1>, "host" : <string>, "tags" : [ <string> ... ], "state" : <num> }
 { "_id" : <shard name2>, "host" : <string>, "tags" : [ <string> ... ], "state" : <num> }
 ...
active mongoses:
  <version> : <num>
autosplit:
  Currently enabled: <yes|no>
balancer:
      Currently enabled:  yes
      Currently running:  yes
      Collections with active migrations:
              config.system.sessions started at Fri May 15 2020 17:38:12 GMT-0400 (EDT)
      Failed balancer rounds in last 5 attempts:  0
      Migration Results for the last 24 hours:
             416 : Success
             1 : Failed with error 'aborted', from shardA to shardB
      databases:
       { "_id" : <dbname1>, "primary" : <string>, "partitioned" : <boolean>, "version": <document> }
        <dbname>.<collection>
           shard key: { <shard key> : <1 or hashed> }
           unique: <boolean>
           balancing: <boolean>
           chunks:
              <shard name1> <number of chunks>
              <shard name2> <number of chunks>
              ...
           { <shard key>: <min range1> } -->> { <shard key> : <max range1> } on : <shard name> <last modified timestamp>
           { <shard key>: <min range2> } -->> { <shard key> : <max range2> } on : <shard name> <last modified timestamp>
           ...
           tag: <tag1>  { <shard key> : <min range1> } -->> { <shard key> : <max range1> }
           ...
       { "_id" : <dbname2>, "primary" : <string>, "partitioned" : <boolean>, "version": <document> }
       ...
```

- ì²­í¬ê°€ ì—¬ëŸ¬ ê°œì´ë©´ `sh.status()`ëŠ” ê° ì²­í¬ë¥¼ ì¶œë ¥í•˜ê¸°ë³´ë‹¤ëŠ” ì²­í¬ ìƒíƒœë¥¼ ìš”ì•½í•œë‹¤.
- ëª¨ë“  ì²­í¬ë¥¼ ë³´ë ¤ë©´ `sh.status(true)`ë¥¼ ì‹¤í–‰í•œë‹¤.(`true`ë¥¼ ì…ë ¥í•˜ë©´ ìƒì„¸í•œ ì •ë³´ë¥¼ ì¶œë ¥í•œë‹¤)
- `sh.status()`ëŠ” `config` ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìˆ˜ì§‘í•œ ì •ë³´ë¥¼ ëª¨ë‘ ë³´ì—¬ì¤€ë‹¤.

### 1-2. êµ¬ì„± ì •ë³´ í™•ì¸í•˜ê¸°

---

- í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ ëª¨ë“  êµ¬ì„± ì •ë³´ëŠ” êµ¬ì„± ì„œë²„ì˜ `config` ë°ì´í„°ë² ì´ìŠ¤ ë‚´ ì»¬ë ‰ì…˜ì— ë³´ê´€ëœë‹¤.
- ì…¸ ë³´ì¡°ìë¥¼ ì‚¬ìš©í•˜ë©´ êµ¬ì„± ì •ë³´ë¥¼ ë” ì½ê¸° ì‰½ê²Œ ë³¼ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ë ¤ë©´ ì–¸ì œë“ ì§€ `config` ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì§ì ‘ ì¿¼ë¦¬í•  ìˆ˜ ìˆë‹¤.
    
    ```bash
    > use config
    ```
    
- ì¼ë°˜ì ìœ¼ë¡œ `config` ë°ì´í„°ë² ì´ìŠ¤ì— ë“¤ì–´ ìˆëŠ” ë°ì´í„°ëŠ” ì§ì ‘ ìˆ˜ì •í•˜ë©´ ì•ˆ ëœë‹¤. ë¬´ì–¸ê°€ë¥¼ ìˆ˜ì •í•˜ê³  ë‚˜ë©´ ëª¨ë“  `mongos` ì„œë²„ë¥¼ ì¬ì‹œì‘í•´ì•¼ ë³€ê²½ ì‚¬í•­ì´ ì ìš©ëœë‹¤.

- config.shards: í´ëŸ¬ìŠ¤í„° ë‚´ ëª¨ë“  ìƒ¤ë“œë¥¼ ì¶”ì í•œë‹¤.
    
    ```bash
    > db.shards.find()
    {
      "_id" : "shard01",
      "host" : "shard01/localhost:27018,localhost:27019,localhost:27020",
      "state" : 1
    }
    {
      "_id" : "shard02",
      "host" : "shard02/localhost:27021,localhost:27022,localhost:27023",
      "state" : 1
    }
    
    {
      "_id" : "shard03",
      "host" : "shard03/localhost:27024,localhost:27025,localhost:27026",
      "state" : 1
    }
    ```
    
    - ìƒ¤ë“œì˜ "`_id`"ëŠ” ë³µì œ ì…‹ì˜ ì´ë¦„ì—ì„œ ê°€ì ¸ì˜¨ë‹¤. ê·¸ëŸ¬ë¯€ë¡œ í´ëŸ¬ìŠ¤í„° ì•ˆì— ìˆëŠ” ê° ë³µì œ ì…‹ì˜ ì´ë¦„ì€ ê³ ìœ í•´ì•¼ í•œë‹¤.
- config.databases: í´ëŸ¬ìŠ¤í„°ê°€ ì•Œê³  ìˆëŠ” ëª¨ë“  ìƒ¤ë”© ë° ë¹„ìƒ¤ë”© ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¶”ì í•œë‹¤.
    
    ```bash
    > db.databases.find()
    { "_id" : "video",
      "primary" : "shard02",
      "partitioned" : true,
      ...
    }
    ```
    
    - `enableSharding`ì´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‹¤í–‰ëœ ì ì´ ìˆìœ¼ë©´ "`partitioned`"ëŠ” `true`ê°€ ëœë‹¤.
    - "`primary`"ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ 'í™ˆ ë² ì´ìŠ¤'ë‹¤.
- config.collections: ëª¨ë“  ìƒ¤ë”©ëœ ì»¬ë ‰ì…˜ì„ ì¶”ì í•œë‹¤.
    
    ```bash
    > db.collections.find().pretty()
    {
      "_id": "video.movies",
      ...
      "key" : {
        "imdbId":"hashed"
      },
      "unique" : false,
      ...
    }
    ```
    
    - "`_id`": ì»¬ë ‰ì…˜ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤
    - "`key`": ìƒ¤ë“œ í‚¤. ì—¬ê¸°ì„œëŠ” "`imdbId`"ì— í•´ì‹œëœ ìƒ¤ë“œ í‚¤
    - "`unique`": ìƒ¤ë“œ í‚¤ê°€ ê³ ìœ í•œ ì¸ë±ìŠ¤ëŠ” ì•„ë‹˜ì„ ë‚˜íƒ€ë‚¸ë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ìƒ¤ë“œ í‚¤ëŠ” ê³ ìœ í•˜ì§€ ì•Šë‹¤.
- config.chunks: ëª¨ë“  ì»¬ë ‰ì…˜ ë‚´ ëª¨ë“  ì²­í¬ì˜ ê¸°ë¡ì„ ë³´ê´€í•œë‹¤.
    
    ```bash
    > db.chunks.find().skip(1).limit(1).pretty()
    {
      "_id" : "video.movies-imdbId_MinKey",
      "lastmod" : Timestamp(2,0),
      "lastmodEpoch" : ObjectId("5db........"),
      "ns" : "video.movies",
      "min" : {
        "imdbid" : {"$minKey":1}
      },
      "max" : {
        "imdbid" : {NumberLong("-72........")
      },
      "shard" : "shard01",
      ... 
    }
    ```
    
    - "`_id`": ì²­í¬ì˜ ê³ ìœ  ì‹ë³„ì. ì¼ë°˜ì ìœ¼ë¡œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤, ìƒ¤ë“œ í‚¤, í•˜ìœ„ ì²­í¬ ë²”ìœ„ë‹¤.
    - "`ns`": ì²­í¬ê°€ ìœ„ì¹˜í•œ ì»¬ë ‰ì…˜
    - "`min`": ì²­í¬ ë²”ìœ„(ê²½ê³„ í¬í•¨) ë‚´ ìµœì†Ÿê°’
    - "`max`": ì²­í¬ ë‚´ ëª¨ë“  ê°’ì€ ì´ ê°’ë³´ë‹¤ ì‘ë‹¤.
    - "`shard`": ì²­í¬ê°€ ìœ„ì¹˜í•˜ëŠ” ìƒ¤ë“œ
    - "`lastmod`": ì²­í¬ ë²„ì „ ê´€ë¦¬ë¥¼ ì¶”ì í•œë‹¤.
        - ex> "video.movies-imdbId_MinKey" ì²­í¬ê°€ ë‘ ê°œì˜ ì²­í¬ë¡œ ë¶„í• ëë‹¤ë©´, ì´ì „ì˜ ë‹¨ì¼ ì²­í¬ì™€ ë¶„í• ë¼ì„œ ì‘ì•„ì§„ "video.movies-imdbId_MinKey" ì²­í¬ë¥¼ êµ¬ë³„í•˜ëŠ” ë°©ë²•ì´ í•„ìš”í•˜ë‹¤. ë”°ë¼ì„œ Timestamp ê°’ì˜ ì²« ë²ˆì§¸ êµ¬ì„± ìš”ì†ŒëŠ” ì²­í¬ê°€ ìƒˆ ìƒ¤ë“œë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ëœ íšŸìˆ˜ë¥¼ ë°˜ì˜í•œë‹¤. ë‘ ë²ˆì§¸ êµ¬ì„± ìš”ì†ŒëŠ” ë¶„í•  ìˆ˜ë¥¼ ë°˜ì˜í•œë‹¤.
    - "`lastmodEpoch`": ì»¬ë ‰ì…˜ì˜ ìƒì„± ì‹œê¸°ë¥¼ ì§€ì •í•˜ë©°, ì»¬ë ‰ì…˜ì´ ì‚­ì œë˜ê³  ì¦‰ì‹œ ì¬ìƒì„±ë  ë•Œ ë™ì¼í•œ ì»¬ë ‰ì…˜ ì´ë¦„ì— ëŒ€í•œ ìš”ì²­ì„ êµ¬ë³„í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.****
- config.changelog: ë°œìƒí•œ ë¶„í• ê³¼ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ëª¨ë‘ ê¸°ë¡í•˜ë¯€ë¡œ í´ëŸ¬ìŠ¤í„°ê°€ ë¬´ì—‡ì„ í•˜ê³  ìˆëŠ”ì§€ ì¶”ì í•˜ëŠ” ë° ìœ ìš©í•˜ë‹¤.
    - ë¶„í• 
        
        ```bash
        > db.changelog.find({what: "split"}).pretty()
        {
          ....
          "detail" : {
            "before" : {
              ...
              "lastmod":Timestamp(9,1),
              "lastmodEpoch":Objectid("5bdf72c021b6e...")
            },
            "left" : {
              ...
              "lastmod":Timestamp(9,2),
              "lastmodEpoch":Objectid("5bdf72c021b6e...")    
            },
            "right" : {
              ...
              "lastmod":Timestamp(9,3),
              "lastmodEpoch":Objectid("5bdf72c021b6e...")    
            }
          }
        }
        ```
        
        - ì¶œë ¥ ê²°ê³¼ëŠ” ì»¬ë ‰ì…˜ì˜ ì²« ë²ˆì§¸ ì²­í¬ ë¶„í•  ëª¨ìŠµ
            - ê°ê°ì˜ ìƒˆ ì²­í¬ì—ì„œ "`lastmod`"ì˜ ë‘ ë²ˆì§¸ êµ¬ì„± ìš”ì†Œê°€ ê°±ì‹ ëê³ , ê°’ì€ ê°ê° `Timestamp(9,2)`ì™€ `Timestamp(9,3)`ì´ë‹¤.
    - ë§ˆì´ê·¸ë ˆì´ì…˜
        - ë„¤ ê°œë¡œ ë‚˜ë‰œ ì²´ì¸ì§€ë¡œê·¸ ë„íë¨¼íŠ¸ê°€ ìƒê¸´ë‹¤.
            - í•˜ë‚˜ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ì˜ ì‹œì‘ì„ ëª…ì‹œ
            - í•˜ë‚˜ëŠ” 'ì›ë³¸' ìƒ¤ë“œ
                
                ```bash
                > db.changelog.findOne({what:"moveChunk.to"}) // 'ì›ë³¸' ìƒ¤ë“œì— ì˜í•´ ìƒì„±ëœ ë„íë¨¼íŠ¸
                {
                  ...
                  "what" : "moveChunk.to",
                  "ns" : "video.movies",
                  ...
                  "details" : {
                    ...
                    "step 1 of 6" : 965,
                    "step 2 of 6" : 608,
                    "step 2 of 6" : 15424,
                    "step 4 of 6" : 0,
                    "step 5 of 6" : 72,
                    "step 6 of 6" : 258,
                    "note" : "success"
                    }
                }
                ```
                
                - "`details`"ì— ë‚˜ì—´ëœ ê° ë‹¨ê³„ì—ì„œ ì‹œê°„ì´ ê¸°ë¡ë˜ë©° "stepN of N" ë©”ì„¸ì§€ëŠ” ë‹¨ê³„ì˜ ì†Œìš” ì‹œê°„ì„ ë°€ë¦¬ì´ˆ ë‹¨ìœ„ë¡œ ë³´ì—¬ì¤€ë‹¤.
                - 'ì›ë³¸' ìƒ¤ë“œê°€ `mongos`ë¡œë¶€í„° `moveChunk` ëª…ë ¹ì„ ë°›ìœ¼ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.
                    1. ëª…ë ¹ ë§¤ê°œë³€ìˆ˜ë¥¼ í™•ì¸í•œë‹¤.
                    2. êµ¬ì„± ì„œë²„ê°€ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìœ„í•´ ë¶„ì‚°ëœ ë½ì„ íšë“í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.
                    3. 'ëª©ì ì§€' ìƒ¤ë“œì— ì ‘ì†ì„ ì‹œë„í•œë‹¤.
                    4. ë°ì´í„°ë¥¼ ë³µì‚¬í•œë‹¤. ì´ëŠ” 'the critical section'ìœ¼ë¡œ ëª…ì‹œë¼ ê¸°ë¡ëœë‹¤.
                    5. 'ëª©ì ì§€' ìƒ¤ë“œ ë° êµ¬ì„± ì„œë²„ì™€ ì¡°ì •í•´ ì´ë™ì„ í™•ì •í•œë‹¤.
                - 'ëª©ì ì§€'ì™€ 'ì›ë³¸' ìƒ¤ë“œëŠ” "step 4 of 6"ë¶€í„°ëŠ” ì„œë¡œ í†µì‹ ì´ ê°€ëŠ¥í•œ ìƒíƒœì—¬ì•¼ í•¨. ë§ˆì§€ë§‰ ë‹¨ê³„ì—ì„œ ì›ë³¸ ì„œë²„ì˜ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ ë¹„ì •ìƒì ì´ë¼ë©´, ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ë˜ëŒë¦¬ê±°ë‚˜ ê³„ì† ì§„í–‰í•  ìˆ˜ ì—†ëŠ” ìƒíƒœê°€ ëœë‹¤. ì´ëŸ´ ë•ŒëŠ” `mongod`ê°€ ì¢…ë£Œëœë‹¤.
            - í•˜ë‚˜ëŠ” 'ëª©ì ì§€' ìƒ¤ë“œ
                
                ```bash
                > db.changelog.find({what:"moveChunk.from","details.max.imdbId": .....).pretty()
                {
                  ...
                  "what" : "moveChunk.from",
                  "ns" : "video.movies",
                  "detail" : {
                  ...
                    "step 1 of 6" : 0,
                    "step 2 of 6" : 4,
                    "step 2 of 6" : 191,
                    "step 4 of 6" : 17000,
                    "step 5 of 6" : 341,
                    "step 6 of 6" : 39,
                    "to" : "shard01"
                    "from" : "shard02",
                    "note" : "success"
                  }
                }
                ```
                
                - 'ëª©ì ì§€' ìƒ¤ë“œê°€ 'ì›ë³¸' ìƒ¤ë“œë¡œë¶€í„° ëª…ë ¹ì„ ë°›ìœ¼ë©´ ë‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.
                    1. ì¸ë±ìŠ¤ë¥¼ ë§ˆì´ê·¸ë ˆì´ì…˜í•œë‹¤.
                    2. ì²­í¬ ë²”ìœ„ ì•ˆì— ìˆëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•œë‹¤.
                    3. ì²­í¬ ë‚´ ëª¨ë“  ë„íë¨¼íŠ¸ë¥¼ 'ëª©ì ì§€' ìƒ¤ë“œë¡œ ë³µì‚¬í•œë‹¤.
                    4. ë³µì‚¬í•˜ëŠ” ë™ì•ˆì— ë„íë¨¼íŠ¸ì— ì¼ì–´ë‚œ ì‘ì—…ì„ ì¬ì‹¤í–‰í•œë‹¤.
                    5. 'ëª©ì ì§€' ìƒ¤ë“œê°€ ìƒˆë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ëœ ë°ì´í„°ë¥¼ ëŒ€ë¶€ë¶„ì˜ ì„œë²„ë¡œ ë³µì œí•˜ë„ë¡ ê¸°ë‹¤ë¦°ë‹¤.
                    6. ì²­í¬ì˜ ë©”íƒ€ë°ì´í„°ê°€ 'ëª©ì ì§€' ìƒ¤ë“œì— ìœ„ì¹˜í•œë‹¤ê³  ë°”ê¿”ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ í™•ì •í•œë‹¤.
            - í•˜ë‚˜ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ì— ëŒ€í•œ ì»¤ë°‹ ì •ë³´ë¥¼ í¬í•¨í•œë‹¤.
        - 'ì›ë³¸' ìƒ¤ë“œì™€ 'ëª©ì ì§€' ìƒ¤ë“œì— ëŒ€í•œ ë„íë¨¼íŠ¸ëŠ” í”„ë¡œì„¸ìŠ¤ì—ì„œ ë‹¨ê³„ë³„ë¡œ ì†Œìš”ëœ ì‹œê°„ì˜ ëª…ì„¸ë¥¼ ì œê³µí•œë‹¤.
            - ë§ˆì´ê·¸ë ˆì´ì…˜ì—ì„œ ë³‘ëª© í˜„ìƒì„ ì¼ìœ¼í‚¤ëŠ” ì›ì¸ì´ ë””ìŠ¤í¬ì¸ì§€, ë„¤íŠ¸ì›Œí¬ í˜¹ì€ ë‹¤ë¥¸ ë¬´ì–¸ê°€ì¸ì§€ ì¶”ì •í•  ìˆ˜ ìˆë‹¤.
- config.settings: í˜„ì¬ì˜ ë°¸ëŸ°ì„œ ì„¤ì •ê³¼ ì²­í¬ í¬ê¸°ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë„íë¨¼íŠ¸ë¥¼ í¬í•¨í•œë‹¤. ì»¬ë ‰ì…˜ ë‚´ ë„íë¨¼íŠ¸ë¥¼ ë³€ê²½í•´ì„œ ë°¸ëŸ°ì„œë¥¼ ì¼œê³  ë„ê±°ë‚˜ ì²­í¬ í¬ê¸°ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

## 2. ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì¶”ì 

---

### 2-1. ì—°ê²° í†µê³„ ì •ë³´ ì–»ì–´ì˜¤ê¸°

---

- `connPoolStats`: í˜„ì¬ ë°ì´í„°ë² ì´ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°ë‚˜ ë³µì œ ì…‹ì˜ ë‹¤ë¥¸ ë©¤ë²„ë¡œ ë‚˜ê°€ëŠ” ì—´ë¦° ì—°ê²°ì— ëŒ€í•œ ì •ë³´ë¥¼ ë°˜í™˜í•œë‹¤.
    - ì‹¤í–‰ ì¤‘ì¸ ì‘ì—…ê³¼ ê°„ì„­ì„ í”¼í•˜ë ¤ê³  ë½ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ â†’ ì •ë³´ë¥¼ ìˆ˜ì§‘í•  ë•Œ ê°œìˆ˜ê°€ ì•½ê°„ ë°”ë€Œì–´, í˜¸ìŠ¤íŠ¸ì™€ í’€ ì—°ê²° ê°œìˆ˜ ê°„ì— ì•½ê°„ì˜ ì°¨ì´ê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.

```bash
> db.adminCommnad({"connPoolStats":1})
{
  "numClientConnections" : 10,
  "numAScopedConnections" : 0,
  "totalInUse" : 0,
  "totalAvailable" : 13,
  "totalCreated" : 86,
  "totalRefreshing" : 0,
  "pools" : {
    ...
    "localhost:27017" : {
      "inUse" : 0,
      "available" : 1,
      "created" : 1,
      "refreshing" : 0
    }
    ...
}
```

- "`totalAvailable`": í˜„ì¬ `mongod`/`mongos` ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°ë‚˜ ë³µì œ ì…‹ì˜ ë‹¤ë¥¸ êµ¬ì„±ì›ìœ¼ë¡œ ë‚˜ê°€ëŠ” ì‚¬ìš© ê°€ëŠ¥í•œ ì´ ë°œì‹  ì—°ê²° ìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
- "`totalCreated`": í˜„ì¬ `mongod`/`mongos` ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°ë‚˜ ë³µì œ ì…‹ì˜ ë‹¤ë¥¸ êµ¬ì„±ì›ìœ¼ë¡œ ìƒì„±í•œ ì´ ë°œì‹  ì—°ê²° ìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
- "`totalInUse`": í˜„ì¬ `mongod`/`mongos` ì¸ìŠ¤í„´ìŠ¤ì—ì„œ í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°ë‚˜ ë³µì œ ì…‹ì˜ ë‹¤ë¥¸ êµ¬ì„±ì›ìœ¼ë¡œ ë‚˜ê°€ëŠ” ì´ ì—°ê²° ìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
- "`totalRefreshing`": í˜„ì¬ `mongod`/`mongos` ì¸ìŠ¤í„´ìŠ¤ì—ì„œ í˜„ì¬ ìƒˆë¡œ ìƒˆë¡œê³ ì¹¨ë˜ëŠ” ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°ë‚˜ ë³µì œ ì…‹ì˜ ë‹¤ë¥¸ êµ¬ì„±ì›ìœ¼ë¡œ ë‚˜ê°€ëŠ” ì´ ë°œì‹  ì—°ê²° ìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
- "`numClientConnections`": í˜„ì¬ `mongod`/`mongos` ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°ë‚˜ ë³µì œ ì…‹ì˜ ë‹¤ë¥¸ êµ¬ì„±ì›ìœ¼ë¡œ ë‚˜ê°€ëŠ” í™œì„± ë° ì €ì¥ëœ ë™ê¸° ì—°ê²° ìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
- "`numAScopedConnections`": í˜„ì¬ `mongod`/`mongos` ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°ë‚˜ ë³µì œ ì…‹ì˜ ë‹¤ë¥¸ êµ¬ì„±ì›ìœ¼ë¡œ ë‚˜ê°€ëŠ” í™œì„± ë° ì €ì¥ëœ ë²”ìœ„ ë™ê¸° ì—°ê²° ìˆ˜ë¥¼ ë³´ê³ í•œë‹¤.
- "`pools`": ì—°ê²° í’€ë³„ë¡œ ê·¸ë£¹í™”ëœ ì—°ê²° í†µê³„(ì‚¬ìš© ì¤‘/ì‚¬ìš©ê°€ëŠ¥/ìƒì„±ë¨/ìƒˆë¡œê³ ì¹¨ ì¤‘)ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
    - DBClient ê¸°ë°˜ í’€("`pools`" ë„íë¨¼íŠ¸ì—ì„œ "`global`" í•„ë“œëª…ìœ¼ë¡œ ì‹ë³„ë˜ëŠ” 'ì“°ê¸° ê²½ë¡œ')
    - NetworkInterfaceTL ê¸°ë°˜ í’€('ì½ê¸° ê²½ë¡œ')
- "`hosts`": í˜¸ìŠ¤íŠ¸ë³„ë¡œ ê·¸ë£¹í™”ëœ ì—°ê²° í†µê³„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. í˜„ì¬ `mongod`/`mongos` ì¸ìŠ¤í„´ìŠ¤ì™€ ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°ë‚˜ ë³µì œ ì…‹ì˜ ê° êµ¬ì„±ì› ê°„ì˜ ì—°ê²°ì— ëŒ€í•´ ë³´ê³ í•œë‹¤.

### 2-2. ì—°ê²° ê°œìˆ˜ ì œí•œí•˜ê¸°

---

- í´ë¼ì´ì–¸íŠ¸ê°€ `mongos`ì— ì ‘ì†í•˜ë©´ `mongos`ëŠ” í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ì „ë‹¬í•˜ë ¤ê³  ì ì–´ë„ í•˜ë‚˜ì˜ ìƒ¤ë“œì— ì—°ê²°ì„ ìƒì„±í•œë‹¤.
- `mongos` í”„ë¡œì„¸ìŠ¤ê°€ ì—¬ëŸ¬ ê°œì´ë©´ ìƒ¤ë“œê°€ ë‹¤ë£° ìˆ˜ ìˆëŠ” ì–‘ë³´ë‹¤ ë” ë§ì€ ì—°ê²°ì„ ìƒì„±í•  ìˆ˜ë„ ìˆë‹¤. `mongos`ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ìµœëŒ€ 6ë§Œ 5536ê°œì˜ ì—°ê²°ì„ í—ˆìš©í•˜ë©°, ê°ê° 1ë§Œ ê°œì˜ í´ë¼ì´ì–¸íŠ¸ ì—°ê²°ì„ ê°–ëŠ” 5ê°œì˜ `mongos` í”„ë¡œì„¸ìŠ¤ê°€ ìˆë‹¤ë©´ í•˜ë‚˜ì˜ ìƒ¤ë“œì— 5ë§Œ ê°œì˜ ì—°ê²° ìƒì„±ì„ ì‹œë„í•œë‹¤.
- ì´ë¥¼ ë°©ì§€í•˜ë ¤ë©´ `mongos` ëª…ë ¹í–‰ êµ¬ì„±ì—ì„œ `--maxConns` ì˜µì…˜ì„ ì‚¬ìš©í•´ ìƒì„± ê°€ëŠ¥í•œ ì—°ê²° ê°œìˆ˜ë¥¼ ì œí•œí•˜ë©´ ëœë‹¤.
- ë‹¤ìŒ ê³µì‹ì€ í•˜ë‚˜ì˜ `mongos`ì—ì„œ ìƒ¤ë“œê°€ ë‹¤ë£° ìˆ˜ ìˆëŠ” ì—°ê²°ì˜ ìµœëŒ€ ìˆ˜ë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì‚¬ìš©í•œë‹¤.
    
    ```bash
    maxConns = maxConnsPrimary - (numMembersPerReplicaSet x 3)
    
    (other x 3) / numMongosProcesses
    ```
    
    - : ë¶€ìˆ˜ì ì¸ ì—­í• ì„ í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ ê°œìˆ˜ / ìƒ¤ë“œí´ëŸ¬ìŠ¤í„°ì—ì„œ mongosì˜ ì´ ê°œìˆ˜
    - `maxConnsPrimary`: í”„ë¼ì´ë¨¸ë¦¬ì˜ ìµœëŒ€ ì—°ê²° ìˆ˜. `mongos`ë¡œë¶€í„°ì˜ ì—°ê²°ë¡œ ìƒ¤ë“œë¥¼ ì••ë„í•˜ì§€ ì•Šë„ë¡ ì¼ë°˜ì ìœ¼ë¡œ 2ë§Œìœ¼ë¡œ ì„¤ì •í•œë‹¤.
    - `(numMembersPerReplicaSet x 3)`: í”„ë¼ì´ë¨¸ë¦¬ëŠ” ê° ì„¸ì»¨ë”ë¦¬ì— ì—°ê²°ì„ í•˜ë‚˜ì”© ìƒì„±í•˜ê³ , ì„¸ì»¨ë”ë¦¬ëŠ” í”„ë¼ì´ë¨¸ë¦¬ì— ë‘ ê°œì˜ ì—°ê²°ì„ ìƒì„±í•´ì„œ ì´ ì„¸ ê°œì˜ ì—°ê²°ì´ ìˆë‹¤.
    - `(other x 3)`: `other`ëŠ” ëª¨ë‹ˆí„°ë§ì´ë‚˜ ë°±ì—… ì—ì´ì „íŠ¸ì™€ ê°™ì´ `mongod`ì— ì ‘ì†í•˜ê±°ë‚˜, ì§ì ‘ ì…¸ì— ì—°ê²°í•˜ê±°ë‚˜, ì´ë™ì„ ìœ„í•´ ë‹¤ë¥¸ ìƒ¤ë“œë¡œ ì—°ê²°í•˜ëŠ” ë“± ë¶€ìˆ˜ì ì¸ ì—­í• ì„ í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ ê°œìˆ˜ë‹¤.
    - `numMongosProcesses`: ìƒ¤ë“œ í´ë¼ìŠ¤í„°ì—ì„œ `mongos`ì˜ ì´ ê°œìˆ˜
- â—`--maxConns`ëŠ” ë‹¨ì§€ mongosê°€ ì—°ê²°ì„ ì´ ì´ìƒ ìƒì„±í•˜ì§€ ì•Šë„ë¡ í•¨
    - í•œê³„ì— ì´ë¥¼ ë•Œ íŠ¹ë³„íˆ ë„ì›€ ë˜ëŠ” ë™ì‘ì„ í•˜ì§€ëŠ” ì•Šìœ¼ë©°, ê·¸ì € ìš”ì²­ì„ ë§‰ê³  ì—°ê²°ì´ 'í•´ì œ'ë˜ê¸°ë¥¼ ê¸°ë‹¤ë¦°ë‹¤.

## 3. ì„œë²„ ê´€ë¦¬

---

- í´ëŸ¬ìŠ¤í„°ê°€ ì»¤ì§€ë©´ ìš©ëŸ‰ì„ ì¶”ê°€í•˜ê±°ë‚˜ êµ¬ì„±ì„ ë°”ê¿€ í•„ìš”ê°€ ìˆë‹¤.****

### 3-1. ì„œë²„ ì¶”ê°€

---

- ì–¸ì œë“ ì§€ ìƒˆë¡œìš´ `mongos` í”„ë¡œì„¸ìŠ¤ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.****
    - `mongos`ì˜ `â€”-configdb` ì˜µì…˜ì´ ì˜¬ë°”ë¥¸ êµ¬ì„± ì„œë²„ ì…‹ì„ ëª…ì‹œí•˜ëŠ”ì§€ í™•ì¸í•˜ì.
    - `mongos`ì— í´ë¼ì´ì–¸íŠ¸ê°€ ì¦‰ì‹œ ì—°ê²°í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
- ìƒˆë¡œìš´ ìƒ¤ë“œë¥¼ ì¶”ê°€í•˜ë ¤ë©´ 15ì¥ì—ì„œ ë´¤ë“¯ `addShard` ëª…ë ¹ì„ ì‚¬ìš©í•œë‹¤.

### 3-2. ìƒ¤ë“œì˜ ì„œë²„ ë³€ê²½

---

- ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚¬ìš©í•  ë•Œ, ê° ìƒ¤ë“œì—ì„œ ì„œë²„ë¥¼ ë³€ê²½í•  ìˆ˜ë„ ìˆë‹¤.****
    - ìƒ¤ë“œì˜ ë©¤ë²„ êµ¬ì„±ì„ ë³€ê²½í•˜ë ¤ë©´ (`mongos`ë¥¼ í†µí•˜ì§€ ì•Šê³ ) ìƒ¤ë“œì˜ í”„ë¼ì´ë¨¸ë¦¬ì— ì§ì ‘ ì—°ê²°í•´ ë³µì œ ì…‹ì„ ì¬êµ¬ì„±í•˜ì.
    - í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì€ ë³€ê²½ ì‚¬í•­ì„ ê°€ì ¸ì™€ì„œ `config.shards`ë¥¼ ìë™ìœ¼ë¡œ ìˆ˜ì •í•œë‹¤.
- ìƒ¤ë“œë¥¼ ë…ë¦½ ì‹¤í–‰í˜• ì„œë²„ì—ì„œ ë³µì œ ì…‹ìœ¼ë¡œ ë³€ê²½í•˜ê¸°
    - ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ ë¹ˆ ë³µì œ ì…‹ ìƒ¤ë“œë¥¼ ìƒˆë¡œ ì¶”ê°€í•˜ê³  ë…ë¦½ ì‹¤í–‰í˜• ì„œë²„ ìƒ¤ë“œë¥¼ ì œê±°í•˜ëŠ” ë°©ë²•
    - ë§ˆì´ê·¸ë ˆì´ì…˜ì€ ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ìƒ¤ë“œë¡œ ì˜®ê¸°ëŠ” ì‘ì—…ì„ í•œë‹¤.

### 3-3. ìƒ¤ë“œ ì œê±°

---

- ì¼ë°˜ì ìœ¼ë¡œ ìƒ¤ë“œëŠ” í´ëŸ¬ìŠ¤í„°ì—ì„œ ì œê±°ë˜ë©´ ì•ˆ ëœë‹¤. ì£¼ê¸°ì ìœ¼ë¡œ ìƒ¤ë“œë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ì œê±°í•˜ë©´ ì‹œìŠ¤í…œì— í•„ìš” ì´ìƒìœ¼ë¡œ ë¬´ë¦¬ë¥¼ ì¤€ë‹¤. í•˜ì§€ë§Œ í•„ìš”í•˜ë‹¤ë©´ ìƒ¤ë“œë¥¼ ì œê±°í•  ìˆ˜ ìˆë‹¤.
- ìš°ì„  ë²¨ëŸ°ì„œê°€ ì¼œì§„ ê²ƒì„ í™•ì¸í•œë‹¤.
    - ë°¸ëŸ°ì„œ: ë°°ì¶œ(draining)ì´ë¼ëŠ” í”„ë¡œì„¸ìŠ¤ì—ì„œ, ì œê±°í•˜ë ¤ëŠ” ìƒ¤ë“œì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ë‹¤ë¥¸ ìƒ¤ë“œë¡œ ì´ë™í•˜ëŠ” ì„ë¬´ê°€ ìˆë‹¤.
- ë°°ì¶œì„ ì‹œì‘í•˜ë ¤ë©´ `removeShard` ëª…ë ¹ì„ ì‹¤í–‰í•œë‹¤. `removeShard`ëŠ” ìƒ¤ë“œëª…ì„ ê°€ì ¸ì™€ì„œ ìƒ¤ë“œì˜ ëª¨ë“  ì²­í¬ë¥¼ ë‹¤ë¥¸ ìƒ¤ë“œë¡œ ë°°ì¶œí•œë‹¤.
    
    ```bash
    > db.adminCommand({"removeShard":"shard03"})
    {
      ...
      "state" : "started",
      "shard" : "shard03",
      "note" : "you need to drop or movePrimary these database",
      ...
    }
    
    > db.adminCommand({"removeShard":"shard02"})
    {
      ...
      "state" : "ongoing",
      "remaining" : {
        "chunks" : NumberLong(3),
        "dbs" : NumberLong(0)
      },
      ...
    }
    ```
    
    - `removeShard`ëŠ” ì›í•˜ëŠ” ë§Œí¼ ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.
    - ì²­í¬ë¥¼ ì˜®ê¸°ë ¤ë©´ ë¶„í• í•´ì•¼ í•  ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ, ë°°ì¶œí•˜ëŠ” ë™ì•ˆ ì‹œìŠ¤í…œì—ì„œ ì²­í¬ ê°œìˆ˜ë¥¼ ì¦ê°€í•  ìˆ˜ë„ ìˆë‹¤.
        - ex> ìƒ¤ë“œê°€ 5ê°œì¸ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì²­í¬ê°€ ë‹¤ìŒì²˜ëŸ¼ ë¶„í¬í•œë‹¤ê³  ê°€ì •í•˜ì
            
            ```bash
            test-rs0 10
            test-rs1 10
            test-rs2 10
            test-rs3 11
            test-rs4 11
            ```
            
            - ì´ í´ëŸ¬ìŠ¤í„°ì—ëŠ” ì´ 52ê°œì˜ ì²­í¬ê°€ ìˆë‹¤.
            - test-rs3ì„ ì œê±°í•˜ë©´ ë‹¤ìŒì²˜ëŸ¼ ëœë‹¤.
                
                ```bash
                test-rs0 15
                test-rs1 15
                test-rs2 15
                test-rs4 15
                ```
                
                - 18ê°œëŠ” test-rs3ì—ì„œ ë‚˜ì™”ë‹¤.(11ê°œëŠ” ì‹œì‘í•  ë•Œë¶€í„° ìˆì—ˆê³ , 7ê°œëŠ” ë°°ì¶œ ë¶„í• ì—ì„œ ìƒì„±ëë‹¤)
- ëª¨ë“  ì²­í¬ê°€ ì˜®ê²¨ì¡Œìœ¼ë©´, ì œê±°ëœ ìƒ¤ë“œë¥¼ í”„ë¼ì´ë¨¸ë¦¬ë¡œ í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ê°€ ìˆë‹¤ë©´ ìƒ¤ë“œë¥¼ ì œê±°í•˜ê¸° ì „ì— ë¨¼ì € ì œê±°í•´ì•¼ í•œë‹¤.
    - ì œê±°í•˜ë ¤ëŠ” ìƒ¤ë“œê°€ í´ëŸ¬ìŠ¤í„° ë°ì´í„°ë² ì´ìŠ¤ ì¤‘ í•˜ë‚˜ì˜ í”„ë¼ì´ë¨¸ë¦¬ì´ë©´ `removeShard`ëŠ” "`dbsToMove`" í•„ë“œì— ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë‚˜ì—´í•œë‹¤.
    - ìƒ¤ë“œ ì œê±°ë¥¼ ì™„ë£Œí•˜ë ¤ë©´ ìƒ¤ë“œì—ì„œ ëª¨ë“  ë°ì´í„°ë¥¼ ë§ˆì´ê·¸ë ˆì´ì…˜í•œ í›„ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒˆ ìƒ¤ë“œë¡œ ì´ë™í•˜ê±°ë‚˜, ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚­ì œí•´ì•¼ í•œë‹¤.
    - ì œê±°ë¥¼ ì™„ë£Œí•˜ë ¤ë©´ `movePrimary` ëª…ë ¹ì„ ì‚¬ìš©í•´ ë‚˜ì—´ëœ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì´ë™í•œë‹¤.
        
        ```bash
        > db.adminCommand({"movePrimary":"video", "to":"shard01"})
        ```
        
    - ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ëª¨ë‘ ì˜®ê²¼ìœ¼ë©´ `removeShard`ë¥¼ í•œ ë²ˆ ë” ì‹¤í–‰í•œë‹¤.
        - ì´ ê³¼ì •ì€ ê¼­ í•„ìš”í•˜ì§€ëŠ” ì•Šì§€ë§Œ ì²˜ë¦¬ê°€ ì™„ë£ŒëëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
        
        ```bash
        > db.adminCommand({"removeShard":"shard02"})
        {
          ...
          "state" : "completed",
          "shard" : "shard03",
          ...
        }
        ```
        

## 4. ë°ì´í„° ë°¸ëŸ°ì‹±

---

- ì¼ë°˜ì ìœ¼ë¡œ ëª½ê³  DBëŠ” ìë™ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê· ë“±í•˜ê²Œ ë¶„ì‚°í•œë‹¤.****
- ìë™ ë°¸ëŸ°ì‹± ì‘ì—…ì„ ì¼œê³  ë„ëŠ” ë°©ë²•ê³¼ ë°¸ëŸ°ì‹± ê³¼ì •ì— ê°œì…í•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¬ë‹¤.

### 4-1. ë°¸ëŸ°ì„œ

---

- ëŒ€ë¶€ë¶„ì˜ ê´€ë¦¬ ì‘ì—…ì—ì„œëŠ” ë°¸ëŸ°ì„œë¥¼ ë„ëŠ” ì‘ì—…ì´ ì„ í–‰ëœë‹¤.
    
    ```bash
    > sh.setBalancerState(false)
    ```
    

- ë°¸ëŸ°ì„œê°€ êº¼ì§„ ìƒíƒœì—ì„œëŠ” ìƒˆë¡œìš´ ë°¸ëŸ°ì‹± ì‘ì—…ì´ ì‹œì‘ë˜ì§€ ì•ŠëŠ”ë‹¤.
    - í•˜ì§€ë§Œ ì§„í–‰ ì¤‘ì— ë°¸ëŸ°ì„œë¥¼ ë„ë©´ ë°¸ëŸ°ì‹± ì‘ì—…ì´ ê°•ì œë¡œ ì¤‘ì§€ë˜ì§€ ì•ŠëŠ”ë‹¤.
    - `config.locks` ì»¬ë ‰ì…˜ì„ í™•ì¸í•´ ë°¸ëŸ°ì‹± ì‘ì—…ì´ ì•„ì§ ì§„í–‰ ì¤‘ì¸ì§€ í™•ì¸í•´ì•¼ í•œë‹¤.
        
        ```bash
        > db.locks.find({"_id" : "balancer"})["state"]
        0 // êº¼ì ¸ ìˆìŒ
        ```
        

- ë°¸ëŸ°ì‹± ì‘ì—…ì€ ì‹œìŠ¤í…œì— ë¶€í•˜ë¥¼ ì¤€ë‹¤.
    - ëª©ì ì§€ ìƒ¤ë“œëŠ” ì›ë³¸ ìƒ¤ë“œ ì²­í¬ ì•ˆì— ìˆëŠ” ëª¨ë“  ë„íë¨¼íŠ¸ë¥¼ ì¿¼ë¦¬í•˜ê³  ëª©ì ì§€ ìƒ¤ë“œì— ì…ë ¥í•´ì•¼ í•œë‹¤.
    - ì›ë³¸ ìƒ¤ë“œëŠ” ë„íë¨¼íŠ¸ë¥¼ ì‚­ì œí•´ì•¼ í•œë‹¤.

- ë§ˆì´ê·¸ë ˆì´ì…˜ì´ ì„±ëŠ¥ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆëŠ” ë‘ ê°€ì§€ ìƒí™©
    1. í•«ìŠ¤íŒŸ ìƒ¤ë“œ í‚¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì§€ì†ì ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ì´ ì¼ì–´ë‚œë‹¤.(ìƒˆë¡œìš´ ì²­í¬ê°€ ëª¨ë‘ í•«ìŠ¤íŒŸì— ìƒì„±ë˜ë¯€ë¡œ) ì‹œìŠ¤í…œì€ í•«ìŠ¤íŒŸ ìƒ¤ë“œì—ì„œ ë°œìƒí•˜ëŠ” ë°ì´í„° íë¦„ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
    2. ìƒˆë¡œìš´ ìƒ¤ë“œë¥¼ ì¶”ê°€í•˜ë©´ ë°¸ëŸ°ì„œê°€ í•´ë‹¹ ìƒ¤ë“œë¥¼ ì±„ìš°ë ¤ê³  ì‹œë„í•  ë•Œ ì§€ì†ì ì¸ ë§ˆì´ê·¸ë ˆì´ì…˜ì´ ë°œìƒí•œë‹¤.

ğŸ’¡ë§ˆì´ê·¸ë ˆì´ì…˜ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤ê³  íŒë‹¨í•˜ë©´ `config.settings` ì»¬ë ‰ì…˜ì—ì„œ ë°¸ëŸ°ì‹± ì‘ì—…í•  ì‹œê°„ëŒ€ë¥¼ ì˜ˆì•½í•˜ì.

- ex> ë°¸ëŸ°ì‹± ì‘ì—…ì´ ì˜¤í›„ 1ì‹œì—ì„œ 4ì‹œ ì‚¬ì´ì— ì‹¤í–‰ë˜ë„ë¡ ë‹¤ìŒ ê°±ì‹ ì„ ì‹¤í–‰í•˜ì.
    - 1. ë¨¼ì € ë°¸ëŸ°ì„œê°€ ì¼œì ¸ ìˆëŠ”ì§€ í™•ì¸í•œ ë‹¤ìŒ ì‹œê°„ëŒ€ë¥¼ ì„¤ì •í•œë‹¤.
        
        ```bash
        > sh.setBalancerState(true)
        ..
        > db.settings.update(
          { _id : "balancer" },
          { $set : { activeWindow : {start : "13:00", stop : "16:00"} } },
          { upsert : true }
        )
        WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })
        ```
        
    1. í• ë‹¹í•œ ì‹œê°„ì— `mongos`ê°€ ê· í˜• ì¡íŒ í´ëŸ¬ìŠ¤í„°ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆëŠ”ì§€ ë©´ë°€íˆ ì‚´í´ë³´ì.

â—ìˆ˜ë™ ë°¸ëŸ°ì‹± ì‘ì—…ì„ ìë™ ë°¸ëŸ°ì„œì™€ ê°™ì´ ì‚¬ìš©í•˜ë ¤ í•œë‹¤ë©´ ì£¼ì˜í•´ì•¼ í•œë‹¤.

- ìë™ ë°¸ëŸ°ì„œëŠ” í•­ìƒ ì…‹ì˜ í˜„ì¬ ìƒíƒœë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¬´ì—‡ì„ ì´ë™í• ì§€ ê²°ì •í•˜ë©°, ì…‹ì˜ ì´ë ¥ì„ ê³ ë ¤í•˜ì§€ ì•ŠëŠ”ë‹¤.
    - ex> ê°ê° 500ê°œì˜ ì²­í¬ë¥¼ ê°–ëŠ” shardAì™€ shardBê°€ ìˆë‹¤ê³  ê°€ì •í•˜ì.
        - shardAê°€ ë§ì€ ì“°ê¸° ìš”ì²­ì„ ë°›ê²Œ ë¼ ë°¸ëŸ°ì„œë¥¼ ë„ê³  ê°€ì¥ í™œë°œí•œ ì²­í¬ 30ê°œë¥¼ shardBë¡œ ì˜®ê²¼ë‹¤.
        - ì´ë•Œ ë‹¤ì‹œ ë°¸ëŸ°ì„œë¥¼ ì¼œë©´ ì²­í¬ ê°œìˆ˜ë¥¼ ë§ì¶”ë ¤ê³  ë°¸ëŸ°ì„œëŠ” ì¦‰ì‹œ 30ê°œì˜ ì²­í¬ë¥¼ ë‚šì•„ì±„ì„œ shardB ì—ì„œ shardAë¡œ ì´ë™í•œë‹¤.

â†’ ì´ë¥¼ ë°©ì§€í•˜ë ¤ë©´ ë°¸ëŸ°ì„œë¥¼ ì‹œì‘í•˜ê¸° ì „ì— í™œë°œí•˜ì§€ ì•Šì€ ì²­í¬ 30ê°œë¥¼ shardBì—ì„œ shardAë¡œ ì˜®ê¸°ë©´ ëœë‹¤. ê·¸ëŸ¬ë©´ ìƒ¤ë“œ ê°„ ë¶ˆê· í˜•ì€ ì—†ê³  ë°¸ëŸ°ì„œëŠ” ì²­í¬ë¥¼ ê·¸ëŒ€ë¡œ ë‘”ë‹¤.

### 4-2. ì²­í¬ í¬ê¸° ë³€ê²½

---

- ì²­í¬ì—ëŠ” ë„íë¨¼íŠ¸ê°€ 0ê°œë¶€í„° ìˆ˜ë°±ë§Œ ê°œê¹Œì§€ ì¡´ì¬í•  ìˆ˜ ìˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì²­í¬ê°€ í´ìˆ˜ë¡ ë‹¤ë¥¸ ìƒ¤ë“œë¡œ ì´ë™í•˜ëŠ” ë° ì‹œê°„ì´ ë§ì´ ê±¸ë¦°ë‹¤.
    - ê¸°ë³¸ì ìœ¼ë¡œ ì²­í¬ í¬ê¸°ëŠ” 64ë©”ê°€ë°”ì´íŠ¸.

- ë•Œë¡œëŠ” 64ë©”ê°€ë°”ì´íŠ¸ ì²­í¬ë¡œëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ì´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë¦°ë‹¤. ì²­í¬ í¬ê¸°ë¥¼ ì¤„ì—¬ì„œ ì†ë„ë¥¼ ë†’ì¼ ìˆ˜ ìˆë‹¤.
    - ì…¸ì„ í†µí•´ì„œ `mongos`ì— ì—°ê²°í•˜ê³  `config.settings` ì»¬ë ‰ì…˜ì„ ë‹¤ìŒì²˜ëŸ¼ ë³€ê²½í•˜ì.
        
        ```bash
        > db.settings.findOne()
        {
          "_id" : "chunksize",
          "value" : 64
        }
        > db.settings.save({"_id": "chunksize", "value": 32})
        WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })
        ```
        
    - ê¸°ì¡´ ì²­í¬ê°€ ì¦‰ì‹œ ë³€ê²½ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. ìë™ ë¶„í• ì€ ì‚½ì…ì´ë‚˜ ê°±ì‹ ì„ í•  ë•Œë§Œ ë°œìƒí•œë‹¤. ë”°ë¼ì„œ ì²­í¬ í¬ê¸°ë¥¼ ì¤„ì´ê³  ë‚˜ì„œ ëª¨ë“  ì²­í¬ê°€ ìƒˆë¡œìš´ í¬ê¸°ë¡œ ë¶„í• ë˜ëŠ” ë°ëŠ” ì‹œê°„ì´ ê±¸ë¦°ë‹¤.
- ë¶„í• ì€ ì·¨ì†Œí•  ìˆ˜ ì—†ë‹¤. ì²­í¬ í¬ê¸°ë¥¼ ëŠ˜ë¦¬ë©´ ê¸°ì¡´ ì²­í¬ëŠ” ìƒˆ í¬ê¸°ì— ì´ë¥¼ ë•Œê¹Œì§€ ì‚½ì…ì´ë‚˜ ê°±ì‹ ì„ í†µí•´ì„œë§Œ ì»¤ì§„ë‹¤. ì²­í¬ í¬ê¸°ì˜ í—ˆìš© ë²”ìœ„ëŠ” 1~1024ë©”ê°€ë°”ì´íŠ¸ë‹¤.(ê²½ê³„ í¬í•¨)

â—ì´ëŠ” ëª¨ë“  ì»¬ë ‰ì…˜ê³¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” í´ëŸ¬ìŠ¤í„° ì „ì—­ ì„¤ì •ì„ì„ ì•Œì•„ë‘ì.****

### 4-3. ì²­í¬ ì´ë™

---

- ì²­í¬ ë‚´ ëª¨ë“  ë°ì´í„°ëŠ” íŠ¹ì • ìƒ¤ë“œì— ìë¦¬ ì¡ëŠ”ë‹¤. ê·¸ ìƒ¤ë“œê°€ ë‹¤ë¥¸ ìƒ¤ë“œë³´ë‹¤ ë” ë§ì€ ì²­í¬ë¥¼ ê°€ì§€ë©´ ëª½ê³ DBëŠ” ì¼ë¶€ ì²­í¬ë¥¼ ì˜®ê²¨ë²„ë¦°ë‹¤.
- ìˆ˜ë™ìœ¼ë¡œ ì²­í¬ë¥¼ ì´ë™
    
    ```bash
    > sh.moveChunk("video.movies", {imdbId : 500000}, "shard02")
    { "millis": 4079, "ok": 1 }
    ```
    
    - ì˜®ê¸¸ ì²­í¬ë¥¼ ì°¾ìœ¼ë ¤ë©´ ìƒ¤ë“œ í‚¤ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.(ì—¬ê¸°ì„œëŠ” "imdbId")
        - "imdbId"ê°€ 500000ì¸ ë„íë¨¼íŠ¸ê°€ í¬í•¨ëœ ì²­í¬ë¥¼ shard02ë¡œ ì´ë™í•œë‹¤.
        - ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ ì²­í¬ì˜ í•˜í•œê°’ìœ¼ë¡œ ì§€ì •í•˜ëŠ” ë°©ë²•ì´ë‹¤.
    - ì´ ëª…ë ¹ì€ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ê¸° ì „ì— ì²­í¬ë¥¼ ì´ë™í•˜ê¸° ë•Œë¬¸ì— ì‹¤í–‰í•˜ëŠ” ë° ì‹œê°„ì´ ê±¸ë¦°ë‹¤.
- ì²­í¬ê°€ ìµœëŒ€ ì²­í¬ í¬ê¸°ë³´ë‹¤ ë” í¬ë©´ `mongos`ëŠ” ì²­í¬ë¥¼ ì˜®ê¸°ê¸°ë¥¼ ê±°ë¶€í•œë‹¤.
    
    ```bash
    > sh.moveChunk("video.movies" , {imdbId : NumberLong("83..."}, "shard02")
    {
      "cause" : {
        "chunkTooBig": true,
        ...
        "errMsg" : "chunk too big to move"
      }
    }
    ```
    
    - ì²­í¬ë¥¼ ì˜®ê¸°ê¸° ì „ì— `splitAt` ëª…ë ¹ì„ ì‚¬ìš©í•´ ìˆ˜ë™ìœ¼ë¡œ ë¶„í• í•´ì•¼ í•œë‹¤.
        
        ```bash
        > db.chunk.find({ns : "video.movies","min.imdbId":NumberLong("6386...")}).pretty()
        {
          ...
          "min" : {"imdbId" : NumberLong("6386...") },
          "max" : {"imdbId" : NumberLong("8345...") },
          ...
        }
        
        > sh.splitAt("video.movies", {"imdbIid": NumberLong("70000000000")})
        
        > db.chunk.find(ns: "video.movies", "min.imdbId": NumberLong("6386...")}).pretty()
        {
          ...
          "min" : {"imdbId" : NumberLong("6386...") },
          "max" : {"imdbId" : NumberLong("70000000000") },
          ...
        }
        ```
        
    - ì²­í¬ê°€ ì‘ì€ ì¡°ê°ìœ¼ë¡œ ë¶„í• ë˜ê³  ë‚˜ë©´ ì˜®ê¸¸ ìˆ˜ ìˆë‹¤. ìµœëŒ€ ì²­í¬ í¬ê¸°ë¥¼ ëŠ˜ë¦° í›„ ì˜®ê¸¸ ìˆ˜ë„ ìˆì§€ë§Œ, í° ì²­í¬ëŠ” ìª¼ê°¤ ìˆ˜ ìˆì„ ë•Œë§ˆë‹¤ ìª¼ê°œì•¼ í•œë‹¤.****

### 4-4. ì ë³´ ì²­í¬

---

- ìƒ¤ë“œ í‚¤ë¡œ "date" í•„ë“œë¥¼ ì„ íƒí–ˆë‹¤ê³  ê°€ì •í•˜ì.
    - "date" í•„ë“œëŠ” 'ë…„/ì›”/ì¼' ì²˜ëŸ¼ ë³´ì´ëŠ” ë¬¸ìì—´ì´ë©°, `mongos`ëŠ” ì²­í¬ë¥¼ í•˜ë£¨ì— í•œ ê°œê¹Œì§€ë§Œ ìƒì„±í•  ìˆ˜ ìˆë‹¤.
    - ê°‘ìê¸° í‰ì†Œë³´ë‹¤ 1000ë°°ë‚˜ ë§ì€ íŠ¸ë˜í”½ â†’ ì²­í¬ëŠ” ë‹¤ë¥¸ ë‚ ë³´ë‹¤ í›¨ì”¬ ì»¤ì§€ì§€ë§Œ ëª¨ë“  ë„íë¨¼íŠ¸ê°€ ìƒ¤ë“œ í‚¤ë¡œ ë™ì¼í•œ ê°’ì„ ê°–ê¸° ë•Œë¬¸ì— ì „í˜€ ë¶„í• ë˜ì§€ ì•ŠëŠ”ë‹¤.
    - ì²­í¬ê°€ `config.settings`ì— ì„¤ì •ëœ ìµœëŒ€ ì²­í¬ í¬ê¸°ë³´ë‹¤ ì»¤ì§€ë©´ ë°¸ëŸ°ì„œëŠ” ì²­í¬ë¥¼ ì´ë™í•  ìˆ˜ ì—†ë‹¤.
- ë‚˜ëˆŒ ìˆ˜ë„, ì˜®ê¸¸ ìˆ˜ë„ ì—†ëŠ” ì´ ì²­í¬ë¥¼ ì ë³´ ì²­í¬ë¼ê³  í•œë‹¤.

- í•œ ìƒ¤ë“œê°€ ë‹¤ë¥¸ ê²ƒë“¤ë³´ë‹¤ í›¨ì”¬ ë¹¨ë¦¬ ì»¤ì§€ëŠ” ìƒí™©ì€ ì ë³´ ì²­í¬ ë¬¸ì œê°€ ìˆìŒì„ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œ
    - ì ë³´ ì²­í¬ê°€ ìˆëŠ”ì§€ `sh.status()`ë¡œ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, ì ë³´ ì²­í¬ëŠ” `jumbo`ë¼ê³  í‘œì‹œëœë‹¤.
        
        ```bash
        > sh.status()
        ...
          {"x": -7} --> {"x": 5 } on : shard0001
          {"x": 5} --> {"x": 6 } on : shard0001 jumbo
          {"x": 6} --> {"x": 7 } on : shard0001 jumbo
          {"x": 7} --> {"x": 339 } on : shard0001
        ...
        ```
        
- `dataSize` ëª…ë ¹ìœ¼ë¡œ ì²­í¬ í¬ê¸°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
    - `db.chunks` ì»¬ë ‰ì…˜ìœ¼ë¡œ ì²­í¬ ë²”ìœ„ë¥¼ í™•ì¸
        
        ```bash
        > use config
        > var chunks = db.chunks.find({"ns": "acme.analytics"}).toArray()
        ```
        
    - ì²­í¬ ë²”ìœ„ë¥¼ ì‚¬ìš©í•´ ì ë³´ ì²­í¬ì¼ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ì²­í¬ë¥¼ ì°¾ëŠ”ë‹¤.
        
        ```bash
        > use <dbNmae>
        > db.runCommand({"dataSize": "<dbName.collName>",
        ... "keyPattern": {"date": 1}, // shard key
        ... "min": chunks[0].min,
        ... "max": chunks[0].max})
        {
          "size": 33567917,
          "numObjects": 108942,
          "millis": 634,
          "ok": 1,
          ...
        }
        ```
        
    
    â—`dataSize` ëª…ë ¹ì´ ì²­í¬ í¬ê¸°ë¥¼ ì•Œì•„ë‚´ë ¤ë©´ ì²­í¬ì˜ ë°ì´í„°ë¥¼ ìŠ¤ìº”í•´ì•¼ í•œë‹¤ëŠ” ì ì— ì£¼ì˜í•˜ì.
    
    â†’ ê°€ëŠ¥í•˜ë©´ ë°ì´í„°ì— ëŒ€í•œ ì •ë³´ë¥¼ í™œìš©í•´ ê²€ìƒ‰ ë²”ìœ„ë¥¼ ì¢íˆì.
    

- ì ë³´ ì²­í¬ ë¶„ì‚°í•˜ê¸°
    - ì ë³´ ì²­í¬ ë•Œë¬¸ì— ê· í˜•ì´ ê¹¨ì§„ í´ëŸ¬ìŠ¤í„°ë¥¼ ë°”ë¡œì¡ìœ¼ë ¤ë©´ ìƒ¤ë“œ ê°„ì— ì ë³´ ì²­í¬ë¥¼ ê³ ë¥´ê²Œ ë¶„ì‚°í•´ì•¼ í•œë‹¤.
    - ì´ ë°©ë²•ì€ ë³µì¡í•œ ìˆ˜ì‘ì—…ì´ê¸´ í•˜ì§€ë§Œ, ë‹¤ìš´íƒ€ì„ì´ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.(ë§ì€ ë°ì´í„°ë¥¼ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ë¯€ë¡œ ëŠë ¤ì§ˆ ìˆ˜ëŠ” ìˆë‹¤)
        - ì„¤ëª…ì—ì„œ ì ë³´ ì²­í¬ê°€ ìˆëŠ” ìƒ¤ë“œëŠ” 'ì›ë³¸' ìƒ¤ë“œë¡œ ê°„ì£¼í•œë‹¤. ì ë³´ ì²­í¬ê°€ ë§ˆì´ê·¸ë ˆì´ì…˜í•  ìƒ¤ë“œëŠ” 'ëª©ì ì§€' ìƒ¤ë“œë¼ê³  í•œë‹¤. ì²­í¬ë¥¼ ì˜®ê¸°ë ¤ëŠ” 'ì›ë³¸' ìƒ¤ë“œê°€ ì—¬ëŸ¬ ê°œì¼ ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ì•Œì•„ë‘ì.
        - ê° 'ì›ë³¸' ìƒ¤ë“œì— ë‹¤ìŒ ë‹¨ê³„ë¥¼ ë°˜ë³µí•œë‹¤.
        1. ë°¸ëŸ°ì„œë¥¼ ì¢…ë£Œí•œë‹¤. ì´ ê³¼ì •ì´ ì§„í–‰ë˜ëŠ” ë™ì•ˆ ë°¸ëŸ°ì„œì˜ 'ë„ì›€'ì€ í•„ìš”í•˜ì§€ ì•Šë‹¤.
            
            ```bash
            > sh.setBalancerState(false)
            ```
            
        2. ìµœëŒ€ ì²­í¬ë³´ë‹¤ í° ì²­í¬ë¥¼ ì˜®ê¸°ëŠ” ê²ƒì„ í—ˆìš©í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì²­í¬ í¬ê¸°ë¥¼ ì¼ì‹œì ì„ ëŠ˜ë¦°ë‹¤.
            
            ```bash
            > use config
            > db.settings.save({"_id": "chunksize", "value": 10000})
            ```
            
        3. `moveChunk` ëª…ë ¹ìœ¼ë¡œ ì ë³´ ì²­í¬ë¥¼ 'ì›ë³¸' ìƒ¤ë“œì—ì„œ ì˜®ê¸´ë‹¤.
        4. 'ëª©ì ì§€' ìƒ¤ë“œë“¤ê³¼ ì²­í¬ ê°œìˆ˜ê°€ ë¹„ìŠ·í•´ì§ˆ ë•Œê¹Œì§€ 'ì›ë³¸' ìƒ¤ë“œì— ë‚¨ì•„ìˆëŠ” ì²­í¬ì— `splitChunk`ë¥¼ ì‹¤í–‰í•œë‹¤.
        5. ì²­í¬ í¬ê¸°ë¥¼ ì›ë˜ ê°’ìœ¼ë¡œ ì„¤ì •í•œë‹¤.
            
            ```bash
            > db.settings.save({"_id": "chunksize", "value": 64})
            ```
            
        6. ë°¸ëŸ°ì„œë¥¼ ì¼ ë‹¤.
            
            ```bash
            > sh.setBalancerState(true)
            ```
            
    
    â—ë°¸ëŸ°ì„œê°€ ë‹¤ì‹œ ì¼œì§€ë©´ ë‹¤ì‹œ ì ë³´ ì²­í¬ë¥¼ ì´ë™í•  ìˆ˜ ì—†ê²Œ ëœë‹¤.****
    

- ì ë³´ ì²­í¬ ë°©ì§€í•˜ê¸°
    - ì ë³´ ì²­í¬ë¥¼ ë°©ì§€í•˜ë ¤ë©´ ìƒ¤ë“œ í‚¤ë¥¼ ë” ê³ ë¥´ê²Œ ë¶„í¬ëœ ê²ƒìœ¼ë¡œ ë°”ê¾¼ë‹¤.

### 4-5. êµ¬ì„± ê°±ì‹ 

---

- ë•Œë¡œëŠ” `mongos`ê°€ êµ¬ì„± ì„œë²„ì—ì„œ ê°€ì ¸ì˜¨ êµ¬ì„±ì„ ì˜¬ë°”ë¥´ê²Œ ê°±ì‹ í•˜ì§€ ì•ŠëŠ”ë‹¤.
- `flushRouterConfig` ëª…ë ¹ìœ¼ë¡œ ìˆ˜ë™ìœ¼ë¡œ ëª¨ë“  ìºì‹œë¥¼ ì •ë¦¬í•œë‹¤.
    
    ```bash
     > db.adminCommand({"flushRouterConfig": 1} )
    ```
    
- `flushRouterConfig`ê°€ ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ëª¨ë“  `mongos` í˜¹ì€ `mongod` í”„ë¡œì„¸ìŠ¤ë¥¼ ì¬ì‹œì‘í•´ì„œ ëª¨ë“  ìºì‹œ ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ì.

- ì°¸ê³ 
    - [https://www.mongodb.com/docs/v6.0/reference/method/sh.status/](https://www.mongodb.com/docs/v6.0/reference/method/sh.status/)
    - [https://github.com/kdh92/kdh92.github.io/blob/main/ëª½ê³ DBì™„ë²½ê°€ì´ë“œ/13.ê´€ë¦¬.md](https://github.com/kdh92/kdh92.github.io/blob/main/%EB%AA%BD%EA%B3%A0DB%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C/13.%EA%B4%80%EB%A6%AC.md)