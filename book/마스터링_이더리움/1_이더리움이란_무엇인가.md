# Chapter 1. 이더리움이란 무엇인가?

- 이더리움이란?
    - 컴퓨터 과학의 관점
        - 이더리움은 결정론적이지만, 사실상 한정되지 않은 상태 머신이며, 이것은 전역적으로 접근 가능한 싱글톤 상태와 그 상태를 변화시킬 수 있는 가상 머신으로 구성되어 있다.
    - 좀 더 실용적인 관점
        - 이더리움은 스마트 컨트랙트라는 프로그램을 실행하는 오픈 소스에 기반을 둔, 전 세계에 걸쳐 탈중앙화된 컴퓨팅 인프라스트럭처다.
        - 블록체인을 사용하여 시스템의 상태 변화를 동기화하고 저장하며, 이더라고 하는 암호화폐를 이용하여 실행 자원 비용을 측정하고 제한한다.
- 개발자는 이더리움 플랫폼을 사용해서 경제적 기능들을 내장한 강력하면서도 탈중앙화된 애플리케이션을 개발할 수 있다.
- 이더리움 플랫폼은 고가용성, 검사 가능성, 투명성, 중립성 을 제공하는 동시에 검열을 줄이거나 없애고, 거래상대방의 위험을 줄인다.


## 1. 비트코인과의 비교

- 다른 개방형 블록체인과 공통요소
    - 피어투피어(p2p) 네트워크: 참여자들을 연결한다.
    - 비잔틴 결함 허용 합의 알고리즘(작업증명 블록체인): 상태 변경을 동기화
    - 디지털 서명과 해시
    - 디지털 화폐(이더) 같은 암호학 기반 기술 사용

- 이더리움의 주된 목적은 그 자체로 디지털 화폐 지급 네트워크가 되는 것 이 아니다.
    - 비트코인을 포함한 이전의 개방형 블록체인과 현저히 다른점
    - 디지털 화폐인 이더는 이더리움의 한 부분
    - 이더: 월드 컴퓨터로서의 이더리움 플랫폼 사용료를 지불하기 위한 유틸리티 화폐

- 비트코인과의 차이
    - 비트코인: 매우 제한된 스크립트 언어를 사용해야 한다.
        - 비트코인의 스크립트 언어가 의도적으로 지불 조건에 대한 단순한 참/거짓 평가에만 제한되어 있다.
    - 이더리움: 임의성, 무한 복잡성을 가진 코드를 실행할 수 있는 가상 머신을 운영하는 범용 프로그래밍이 가능한 블록체인
        - 튜링 완전 언어: 이더리움이 범용 컴퓨터로 직접 작동할 수 있음을 의미한다.


## 2. 블록체인 구성요소

- 공개 블록체인의 구성요소
    - 표준화된 '가십' 프로토콜을 기반으로 참여자를 연결하고 트랜잭션 및 검증된 트랜잭션 블록을 연결하는 P2P 네트워크
    - 상태 전이를 나타내는 트랜잭션 형식의 메시지
    - 트랜잭션의 구성 요건과 유효성을 판단하는 합의 규칙의 집합
    - 합의 규칙에 따라 트랜잭션을 처리하는 상태 머신
    - 검증되고 적용된 모든 상태 전이의 장부 역할을 해줄 수 있는, 암호학적으로 보호된 체인
    - 합의 규칙들을 적용하는 데 모든 참여자가 협력할 수 있도록 강제함으로써 블록체인의 통제 권한을 탈중앙화하는 합의 알고리즘
    - 공개된 환경에서 상태 머신에 경제적인 보안성을 제공할 수 있는 게임 이론적으로 유효한 인센티브 메커니즘(예: 작업증명 비용 + 블록 보상)
    - 위에서 언급된 것들을 구현한 하나 이상의 오픈 소스 소프트웨어('clients')

- 일반적으로 이러한 구성요소의 전부 또는 대부분은 단일 소프트웨어 클라이언트로 통합된다.
    - 비트코인에서 기준이 되는 구현체는 비트코인 코어 오픈 소스 프로젝트가 개발하고, 이것은 bitcoind 라는 클라이언트 소프트웨어로 개발된다.
    - 이와 달리 이더리움에는 기준이 되는 구현체가 아닌 기준 사양(Yellow Paper 에서 밝히고 있는 시스템의 수학적 기술)을 사용한다.
- 블록체인
    - 과거에는 위의 모든 구성요소를 포함하는 기술 조합으로 간략하게 표현하기 위해 블록체인 이라 불렀다.
    - 그러나 오늘날에는 서로 다른 속성을 지닌 많은 종류의 블록체인이 존재한다.
    - 블록체인이 가지는 핵심적 성격을 식별하게 해줄 평가 기준들
        - 개방성
        - 공공성
        - 국제화
        - 탈중앙화
        - 중립성
        - 검열 저항성


## 3. 이더리움의 탄생

- 비트코인은 오프체인 → 공개 블록체인을 사용하는 많은 장점을 없애버렸다.
- 온체인 상태에서 더 많은 자유와 유연성이 필요한 프로젝트에는 새로운 블록체인이 유일한 옵션이었다.
    - 모든 인프라 요소의 부트스트래핑, 철저한 시험 등 수많은 작업이 필요함을 의미

- 이더리움은 세부사항을 추상화하고 탈중앙화 블록체인 애플리케이션을 위한 결정적이고 안전한 프로그래밍 환경을 제공한다.
    - 개발자가 P2P 네트워크, 블록체인, 합의 알고리즘 등의 기본 메커니즘을 구현하지 않고도 특정 애플리케이션을 프로그래밍할 수 있다.
- 2015/7/30 첫 이더리움 블록이 채굴되었다. 월드 컴퓨터가 세상에 서비스를 제공하기 시작한 날이다.


## 4. 이더리움 개발의 4단계

- 프론티어 → 홈스테드 → 메트로폴리스 → 세레니티


## 5. 이더리움: 범용 블록체인

- 비트코인의 블록체인은 비트코인 단위 및 소유 상태를 추적한다.
    - 트랜잭션이 상태 전이를 일으켜 코인의 소유권을 변경하는 탈중앙화된 합의 상태 머신
- 범용 저장 프로그램 컴퓨터: 상태 머신에 코드를 로드하고 그 코드를 실행하고 그 결과 상태를 저장할 수 있다.

- 이더리움도 탈중앙화 상태 머신
    - 그러나 화폐 소유 상태만 추적하는 대신 범용 데이터 저장소(키-밸류 튜플) 상태 전이를 추적한다.
    - 특정 키는 임의의 값을 보유하고 그 값을 참고한다.
        - 대부분의 범용 컴퓨터에서 사용되는 랜덤 액세스 메모리의 데이터 스토리지 모델과 동일한 용도로 사용된다.
    - 이더리움에는 코드와 데이터를 저장하는 메모리가 있고, 블록체인을 사용하여 이 메모리가 시간에 따라 어떻게 변하는지 추적한다.
    - 범용 저장 프로그램 컴퓨터와 차이
        - 이더리움의 상태 변화가 합의 규칙에 의해 관리된다.
        - 상태가 전체적으로 배포된다.


## 6. 이더리움의 구성요소

- P2P 네트워크
    - 이더리움은 TCP 포트 30303 으로 접속 가능한 이더리움 메인 네트워크 에서 실행되며, ÐΞVp2p 프로토콜을 실행한다.
- 합의 규칙
    - 기준 사양인 황서(Yellow Paper)에 정의되어 있다.
- 트랜잭션
    - 보낸 사람, 받는 사람, 값 및 데이터 페이로드가 포함된 네트워크 메시지
- 상태 머신
    - 바이트코드를 실행하는 스택 기반 가상 머신 EVM(이더리움 가상 머신)에 의해 처리된다.
    - '스마트 컨트랙트' 라는 EVM 프로그램은 고수준 프로그래밍 언어(ex> 솔리디티)로 작성되고, EVM 에서 실행되도록 바이트코드로 컴파일된다.
- 데이터 구조
    - 이더리움의 상태는 트랜잭션 및 시스템 상태가 머클 패트리샤 트리라는 serialize 된 해시 데이터 구조로, 각 노드의 DB에 저장된다.
- 합의 알고리즘
    - 비트코인의 합의 모델인 나카모토 합의를 사용한다.
    - 순차 단일 서명 블록을 사용하여 작업증명(PoW)의 중요도 가중치가 가장 긴 체인(현재 상태)을 결정한다.
    - 그러나 조만간 지분증명(PoS) 가중 투표 시스템인 코드명 캐스퍼 로 전환할 계획이다.
- 경제적 보안성
    - 현재 이대시(Ethash)라는 작업증명(PoW) 알고리즘을 사용하지만, 항후 지분증명(PoS) 알고리즘을 사용할 예정이다.
- 클라이언트
    - 이더리움은 클라이언트 소프트웨어를 상호운용할 수 있는 몇 가지 구현체를 갖고 있는데, 가장 유명한 것은 게스(Go-Ethereum, Geth)와 패리티(Parity)다.


## 7. 이더리움과 튜링 완전

- 튜링 완전: 튜링 머신을 시뮬레이션하는 데 사용할 수 있다면 시스템이 튜링 완전하다.
    - 튜링은 순차적 메모리에서 기호를 읽고 쓰는 방식으로 기호를 조작하는 상태 머신으로 구성된 컴퓨터의 수학적 모델을 만들었다.
    - 이 구성을 통해 모든 문제를 해결할 수 있는지 나타내는 보편적 계산 가능성에 대한 질문에 답하기 위해 수학적 기초를 제공했다.
    - 튜링은 계산할 수 없는 문제가 있음을 증명했다. → 정지 문제가 해결되지 않는다.
        - 임의로 주어진 튜링 머신이 주어진 입력 테이프에 대해 정지하는가 아닌가를 판정하는 알고리즘의 존재 여부를 묻는 문제.

→ 이러한 시스템을 UTM(유니버설 튜링 머신)이라고 한다.

- 이더리움은 비트코인과 달리 튜링 완전하다.
    - 이더리움 가상 머신이라는 상태 머신 상에서 메모리에 데이터를 읽고 쓰면서 저장된 프로그램을 실행할 수 있는 이더리움 기능은 튜링 완전 시스템을 가능하게 하므로 UTM 이다.
    - 이더리움은 한정된 메모리라는 제한 조건에서 모든 튜링 머신으로 계산될 수 있는 어떠한 알고리즘도 계산할 수 있다.
- 이더리움: 범용 컴퓨팅 아키텍처 + 탈중앙화된 블록체인 → 탈중앙화된 단일 상태(싱글톤) 월드 컴퓨터
- 이더리움 프로그램은 '어디에서나' 실행되지만, 합의 규칙에 의해 보장되는 공통 상태를 만들어낸다.

### '기능'으로서의 튜링 완전

---

- 가장 단순한 튜링 완전 상태 머신: 22개의 명령어 길이를 갖는 상태의 정의와 함께 4개의 상태를 가지고 6개의 기호를 사용한다.
    - 때로는 '우연하게 튜링 완전' 시스템이 발견된다. [http://bit.ly/2Og1VgX](http://bit.ly/2Og1VgX)

- 단점: 튜링 완전은 개방형 액세스 시스템에서는 매우 위험하다.
    - 정지 문제 때문
    - ex> 프린터들은 튜링 완전해서 프린터가 작동 불능 상태가 될 때까지 인쇄 명령을 받을 수도 있다.
        - 튜링 완전은 이더리움이 어떠한 복잡한 프로그램이라도 계산할 수 있음을 의미한다.
        - 하지만 이러한 유연성은 보안과 자원 관리에 몇 가지 어려운 문제를 야기한다.
        - 응답없는 프린터는 껐다가 다시 켜야 하지만, 이는 공개 블록체인에서는 불가능하다.

### 튜링 완전의 함축적 의미

---

- 튜링은 컴퓨터에서 프로그램을 시뮬레이션하여 프로그램 종료 여부를 예측할 수 없음을 증명했다.
    - 프로그램을 실행하지 않고서는 프로그램의 경로를 예측할 수 없다.

- 이더리움의 도전 과제: 모든 참여 노드(클라이언트)는 모든 트랜잭션을 검증하고 그 트랜잭션이 호출하는 스마트 컨트랙트를 실행해야 한다.
    - 이더리움은 스마트 컨트랙트가 종료될지 혹은 실제로 스마트 컨트랙트를 실행하지 않고 얼마나 오랫동안 실행될지를 예측할 수 없다.
    - 경우에 따라 무한루프 가능성도 있다
        - 노드가 유효성 검사를 시도할 때 우연히 또는 의도적으로 스마트 컨트랙트가 영원히 지속하도록 만들 수 있다.
        - 
- 이더리움이 사전에 자원 사용을 예측할 수 없다면 스마트 컨트랙트가 사용하는 자원을 어떻게 제한할까?
    - 가스(gas) 라는 과금 메커니즘 도입
    - EVM 이 스마트 컨트랙트를 실행하게 되면, 가스는 각 명령어(계산, 데이터 접근 등)의 비용을 일일히 계산한다.
    - 각 명령어는 가스 단위로 미리 정해진 비용이 있다.
    - 스마트 컨트랙트를 실행시킬 때 트랜잭션은 스마트 컨트랙트를 실행하는데 사용할 수 있는 가스의 최대 사용량을 가지고 있어야 한다.
    - 만약 가스 사용량을 초과한다면 EVM 은 실행을 중지한다.

- 이더리움 월드 컴퓨터에서 계산 비용을 지급하기 위한 가스를 어떻게 얻는가?
    - 오직 트랜잭션의 부분 구성요소로서만 구매할 수 있으며, 이더로만 살 수 있다.
    - 이더는 트랜잭션과 함께 보내야 하고, 가스 구매를 위해서 허용 가능한 가격을 명시적으로 지정해야 한다.
        - 주유소처럼 가스 가격이 정해져있지 않다.

→ 어떠한 거래소에서도 가스를 직접 취급하는 곳은 찾을 수 없다.

- 트랜잭션을 위해 가스가 구매되고, 계산을 수행하고, 사용하지 않은 가스는 발신자에게 반환된다.


## 8. 범용적인 블록체인에서 탈중앙화 애플리케이션(DApp)으로

- 이더리움의 비전: DApp 프로그래밍을 위한 플랫폼

- DApp: 공개되고 탈중앙화된 P2P 기반 서비스 위에 제공되는 웹 애플리케이션
    - 스마트 컨트랙트보다 넓은 의미를 갖는다.
    - 스마트 컨트랙트와 웹 사용자 인터페이스를 합한 것

- 댑의 최소 구성 요건: 블록체인 스마트 컨트랙트, 웹 프런트엔드 사용자 인터페이스
- 많은 댑은 다음과 같은 탈중앙화 구성요소를 포함한다.
    - 탈중앙화(P2P) 스토리지 프로토콜과 플랫폼
    - 탈중앙화(P2P) 메시지 프로토콜과 플랫폼


## 9. 제3세대 인터넷

- 2004, '웹 2.0' 은 사용자 생성 콘텐츠, 반응형 인터페이스 및 상호작용성에 대한 웹의 진화를 설명하는 용어로 부각되었다.
    - 기술 사양이 아니라 웹 애플리케이션의 새로운 초점을 설명하는 용어

- 댑의 개념: 웹 애플리케이션의 모든 측면에서 P2P 프로토콜로 탈중앙화를 도입하여, www 을 자연스럽게 다음 단계로 발전시키기 위한 것
- 웹3: 웹의 세번째 버전을 의미. 웹 애플리케이션에 초점을 두는 새로운 버전.

- web3.js
    - 브라우저 안에서 실행되는 자바스크립트 애플리케이션과 이더리움 블록체인을 연결한다.
    - 스웜이라는 P2P 스토리지 네트워크와 위스퍼라는 P2P 메시징 서비스를 포함한다.
- web3.js 의 3가지 구성요소는 웹 브라우저에서 동작하는 자바스크립트 라이브러리에 포함되어서 개발자들은 웹3 댑을 구축할 수 있는 완전한 애플리케이션 개발 세트를 갖게 된다.


## 10. 이더리움의 개발 문화

- 비트코인과 달리, 커뮤니티의 개발 문화가 과거보다는 미래에 초점이 맞춰져 있다.
- 이더리움의 구호: 빨리 움직이고 파괴하라


## 11. 왜 이더리움을 배우나?

- 블록체인은 하나의 도매인 내에 여러 분야를 조합함으로써 학습 곡선이 매우 가파르다.
    - 프로그래밍, 정보 보안, 암호학, 경제학, 분산 시스템, p2p 네트워크 등

- 이더리움은 블록체인을 학습할 수 있는 훌륭한 플랫폼이고 여타 블록체인 플랫폼보다 빠르게 대규모 개발자 커뮤니티를 구축해가고 있다.
- 또한 다른 어떤 블록체인보다 개발자가 개발자를 위해 만든 개발자의 블록체인이다.


## 12. 이 책을 통해 배울 수 있는 것들

- 이더리움의 모든 구성요소
- 간단한 트랜잭션부터 시작해서 그것이 어떻게 작동하는지 파악하고, 간단한 컨트랙트를 만들고, 그 컨트랙트를 더 좋게 만들어본다.
- 이더리움을 어떻게 사용하는지, 작동하는지, 왜 그렇게 설계되었는지 배운다.
- 각 구성요소들의 작동 방식과 원리 이해


- [Notion link](https://www.notion.so/Chapter-1-946c3899c75041168769227f9b3548b5)
