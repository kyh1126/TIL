# TDD 리팩토링 by 자바지기 박재성님

[https://www.youtube.com/watch?v=bIeqAlmNRrA](https://www.youtube.com/watch?v=bIeqAlmNRrA)

## 의식적인 연습의 7가지 원칙

1. 효과적인 훈련 기법이 수립되어 있는 기술 연마
2. 개인의 컴포트 존을 벗어난 지점에서 진행, 자신의 현재 능력을 살짝 넘어가는 작업을 지속적으로 시도
3. 명확하고 구체적인 목표를 가지고 진행
4. 신중하고 계획적이다. 즉, 개인이 온전히 집중하고 '의식적'으로 행동할 것을 요구
5. 피드백과 피드백에 따른 행동 변경을 수반
6. 효과적인 심적 표상을 만들어내는 한편으로 심적 표상에 의존
7. 기존에 습득한 기술의 특정 부분을 집중적으로 개선함으로써 발전시키고, 수정하는 과정을 수반


## 1단계 - 단위테스트 연습

- TDD 와 단위테스트는 다르다
- 내가 사용하는 API 사용법을 익히기 위한 학습 테스트에서 시작
    - 자바 String 클래스의 다양한 메소드(함수) 사용법
    - 자바 ArrayList 에 데이터를 추가, 수정, 삭제하는 방법
- 내가 구현하는 메소드 중 input output 이 명확한 클래스 메소드(util성)에 대한 단위 테스트 연습
    - 알고리즘을 학습한다면 알고리즘 구현에 대한 검증을 단위 테스트로 한다. 알고리즘은 Input, Output 이 명확하기 때문에 연습하기 좋다.
- 연습 효과
    - 단위테스트 방법을 학습할 수 있다.
    - 단위테스트 도구(xUnit)의 사용법을 익힐 수 있다.
    - 사용하는 API 에 대한 학습 효과가 있다.


## 2단계 - TDD 연습

- 어려운 문제를 해결하는 것이 목적이 아니라 TDD 연습이 목적.
- 난이도가 낮거나 자신에게 익숙한 문제로 시작하는 것을 추천.
- 웹, 모바일 UI나 DB에 의존관계를 가지지 않는 요구사항으로 연습한다. (장난감 프로젝트)
    - 문자열 덧셈 계산기 요구사항 예제 나옴
- TDD Circle of life
    : Test Passes -> Refactor -> Test Fails


## 3단계 - 메소드 리팩토링

- 정성적인 기준보다는 정량적이고 측정 가능한 방법으로 연습
    - 한 메서드에 오직 한 단계의 들여쓰기(indent)만 한다.
    - else 예약어를 쓰지 않는다.
    - 메소드가 한 가지 일만 하도록 구현하기
    - 로컬 변수가 정말 필요한가?
    - compose method 패턴 적용으로, 함수의 추상화. 모두 같은 단계로 만들기
- 한번에 모든 원칙을 지키면서 리팩토링하려고 연습하지 마라
- 한번에 한 가지 명확하고 구체적인 목표를 가지고 연습하라
- 극단적인 방법으로 연습하는 것이 좋다. 메소드 라인 수 제한을 줄여가면서 연습하는 것도 좋은 방법이다.


### 리팩토링 연습 - 클래스 분리

---
- 요구사항 추가
    - 음수가 들어오면 RuntimeException 발생 -> 테스트코드 하나가 추가된다.
    - 모든 원시값과 문자열을 포장한다
    클래스 분리 연습을 위해 활용할 수 있는 원칙
    - 일급 콜렉션을 쓴다.
    - 3개 이상의 인스턴스 변수를 가진 클래스를 쓰지 않는다.


## 4단계 - 장난감 프로젝트 난이도 높이기

- TDD, 리팩토링 연습하기 좋은 프로그램 요구사항
    - 게임과 같이 요구사항이 명확한 프로그램으로 연습
    - 의존관계(웹, DB, 외부 API 같은 의존관계)가 없이 연습
    - 약간은 복잡한 로직이 있는 프로그램
- 연습하기 좋은 예
    - 로또, 사다리 타기, 볼링 게임 점수판, 체스 게임, 지뢰 찾기 게임


## 5단계 - 의존관계 추가를 통한 난이도 높이기

- 웹, 모바일 UI, DB 와 같은 의존관계를 추가!
- 이때 필요한 역량은
    - 테스트하기 쉬운 코드와 테스트하기 어려운 코드를 보는 눈
    - 테스트하기 어려운 코드를 테스트하기 쉬운 코드로 설계하는 감(sense)

→ 앞 단계 연습을 잘 소화했다면 테스트하기 쉬운 코드와 어려운 코드를 분리하는 역량이 쌓였을 것이다.


## 한 단계 더 나아간 연습하기

- 한 단계 더 나아간 연습을 하고 싶다면
    - 컴파일 에러를 최소화하면서 리팩토링하기
    - ATDD 기반으로 응용 애플리케이션 개발하기
    - 레거시 애플리케이션에 테스트 코드 추가해 리팩토링하기
    - 메인 메소드 실행시키지 않고 완성시키기
    - 컴파일 에러를 최소화
    - 레거시 코드를 TDD 로 만들어보기
- 우리가 TDD, 리팩토링 적용에 실패하는 이유
    : TDD, 리팩토링 연습이 충분하지 않은 상태에서 "레거시 애플리케이션에 테스트 코드 추가해 리팩토링하기"와 같은 높은 난이도에 바로 도전


## 객체지향 생활체조 원칙

규칙 1. 한 메서드에 오직 한 단계의 들여쓰기만 한다

규칙 2. else 예약어를 쓰지 않는다

규칙 3. 모든 원시값과 문자열을 포장한다

규칙 4. 한 줄에 점을 하나만 찍는다

규칙 5. 줄여쓰지 않는다 (축약금지)

규칙 6. 모든 엔티티를 작게 유지한다

규칙 7. 3개 이상의 인스턴스 변수를 가진 클래스를 쓰지 않는다

규칙 8. 일급 콜렉션을 쓴다

규칙 9. 게터/세터/프로퍼티를 쓰지 않는다

by 마틴 파울러 - 소트웍스 앤솔러지

ps. 메소드 인자 개수는 0개가 가장 좋다 by 클린코드


## TDD, 리팩토링 연습을 위해 필요한 것은?

- 조급함 대신 마음의 여유
- 나만의 장난감 프로젝트
- 같은 과제를 반복적으로 구현할 수 있는 인내력, 꾸준함, 성실함


## TDD, 리팩토링 적용 - 개인(주니어) -> 팀

- 생각해 볼 점
    - 사람은 기본적으로 변화를 거부하는 성향
    - 팀은 변화를 거부하는 성향이 더 강함
    - 대부분의 사람들은 변화에 실패한 경험을 가지고 있음

→

말이 안통하면 인정해야 한다. 공감대 형성 실패 또는 필요성을 모르는거..

- 그냥 혼자 묵묵히 하면 된다.
    - 내가 전문가니까, 남이 시켜서 하는게 아니라 나를 위해서, 내가 즐겁기 위해서 부끄럽지 않게 하면 된다.
    - 그러다가 관심있는 사람이 생기면 전파한다.

- 내가 구현한 코드 또는 동료의 관심에서 작은 성공(small success)을 맛본다.
    - 리더가 하지 말라고 하면 그만둔다.
    - 하지만 나는 많이 성장했기 때문에 갈 곳은 많다. 걱정하지 마라. 절대 손해 보는 장사 아니다.
    - 연봉을 올려 이직한다. TDD, 리팩토링 전파를 시도한다. 경력이 쌓이면서 내가 리더가 된다.


## TDD, 리팩토링 적용 - 내가 리더

- 리더가 추가로 생각할 점
    - 1:1 로 공략
    - 팀원이 개선할 부분을 말하고, 해결책을 제안하도록 유도
- 시작하기
    - 팀원들과의 신뢰 형성이 우선
    - 1:1 면담을 통해 개선할 부분 찾기 - 일정 수준의 신뢰가 쌓이기 전까지는 1:1 면담을 많이 해야 한다.
- 1:1 면담에서 한 가지만 기억하자
    - 팀원이 문제점을 이야기할 때 문제점에 대한 해답을 제시하려 하지 말고,
    - '어떻게 하면 될까?', '너라면 어떻게 할 것 같아?'라는 반문을 해라
        (다른사람 입을 통해 나오게 해야 좋다...)

- 1:1 면담, 팀 회고를 통해 우선 순위가 높으면서, 작은 변화를 통해 가장 높은 효과가 있을 것으로 생각하는 Practice 를 선택한다.
    - 선택한 Practice 가 개인, 팀 모두 익숙해질 때 까지 한 가지에 집중한다.
    - 선택한 Practice 로 변화를 완료함으로써 작은 성공을 맛본다. 팀이 같이 작은 성공을 맛보는 것이 중요하다.
- 면담, 회고 -> Practice 선택 -> 한 가지에 집중 -> 작은 성공
    : 팀이 신뢰가 쌓이고 에너지가 생긴다.

- 중요한 것은 어떤 Practice 를 하느냐가 아니다.

    → 현재보다 조금씩 나아지고 있다는 방향성이 중요하다.(느린게 더 빠르다는 말은 여기에 적용된다)

- 작은 성공을 쌓아 큰 성공
    - 장난감 프로젝트로 TDD, 리팩토링 연습해 작은 성공 맛보기
    - 내가 구현하는 코드에 한해 TDD, 리팩토링 적용해 작은 성공 맛보기
    - 동료에게 짝 프로그래밍으로 TDD, 리팩토링 경험 전파애 작은 성공 맛보기
    - 같이 일하는 주변 사람들에게 변화를 만들어 큰 성공 맛보기

- 실패해도 괜찮다
    - 실패하기 전보다는 나는 한 단계 성장한다.
    - 좋은 회사는 실패해도 같이 도전하는 사람을 원한다.
    - 실패의 책임을 묻는다면 그만둔다.

- 외롭고 힘든 길, 가장 필요한 것은 가보지 않은 길에 꾸준히 도전할 수 있는 용기!
- 두려움은 있겠지만 묵묵히 걸어가보면, 옆에서 지지해주는 사람도 많다.


- [Notion link](https://www.notion.so/TDD-by-8baa2e37be034a7bb28b068e9cc6447a)
