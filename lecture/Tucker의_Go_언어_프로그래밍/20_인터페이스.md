# 20μ¥. μΈν„°νμ΄μ¤

## μΈν„°νμ΄μ¤

---

- κµ¬μ²΄ν™”λ κ°μ²΄(Conrete object)κ°€ μ•„λ‹ μ¶”μƒν™”λ μƒνΈμ‘μ©μΌλ΅ κ΄€κ³„λ¥Ό ν‘ν„
    - Goλ” Methodλ΅ κ΄€κ³„λ¥Ό ν‘ν„ν•λ‹¤. κ·Έλ°λ° κµ¬ν„μ΄ μλ‹¤λ³΄λ‹ κ΄€κ³„λ§ ν‘ν„ν•μ§„ μ•λ”λ‹¤.
    - μΈν„°νμ΄μ¤κ°€ κ΄€κ³„λ§μ„ ν‘ν„ν•λ‹¤.

### μΈν„°νμ΄μ¤ μ„ μ–Έ

---

![Untitled](./image/20/Untitled.png)

- μΈν„°νμ΄μ¤λ„ νƒ€μ…μ΄λ‹¤.

### μΈν„°νμ΄μ¤ κ·μΉ™

---

1. λ©”μ„λ“λ” λ°λ“μ‹ λ©”μ„λ“λ…μ΄ μμ–΄μ•Ό ν•©λ‹λ‹¤.
2. λ§¤κ°λ³€μμ™€ λ°ν™μ΄ λ‹¤λ¥΄λ”λΌλ„ μ΄λ¦„μ΄ κ°™μ€ λ©”μ„λ“λ” μμ„ μ μ—†μµλ‹λ‹¤.
3. μΈν„°νμ΄μ¤μ—μ„λ” λ©”μ„λ“ κµ¬ν„μ„ ν¬ν•¨ν•μ§€ μ•μµλ‹λ‹¤.

![Untitled](./image/20/Untitled%201.png)

- ex20.1.go
    
    ```go
    package main
    
    import "fmt"
    
    type Stringer interface {
    	String() string
    }
    
    type Student struct {
    	Name string
    	Age  int
    }
    
    func (s Student) String() string {
    	return fmt.Sprintf("μ•λ…•! λ‚λ” %dμ‚΄ %sλΌκ³  ν•΄", s.Age, s.Name)
    }
    
    func (s Student) GetAge() int {
    	return s.Age
    }
    
    func main() {
    	student := Student{"μ² μ", 12}
    	var stringer Stringer
    
    	stringer = student
    	fmt.Printf("%s\n", stringer.String())
    
    	// stringer.GetAge() // interfaceμ ν•¨μλ§ νΈμ¶ν•  μ μλ‹¤.
    }
    ```
    
- μ‹¤ν–‰
    
    ```powershell
    yoonhee@Yoonhee ex20.1 % ./ex20.1 
    μ•λ…•! λ‚λ” 12μ‚΄ μ² μλΌκ³  ν•΄
    ```
    
    - Studentκ°€ String()μ΄λΌλ” λ©”μ†λ“λ¥Ό κµ¬ν„ν•κ³  μμΌλ―€λ΅ μΈν„°νμ΄μ¤μ— ν• λ‹Ήν•  μ μλ‹¤.

## μΈν„°νμ΄μ¤ μ™ μ“°λ‚?

---

![Untitled](./image/20/Untitled%202.png)

### μμ 

---

- ch20 λ””λ ‰ν† λ¦¬ λ§λ“¤κ³  fedex λ””λ ‰ν† λ¦¬ λ§λ“¤κ³  fedex.go μ‘μ„±
    
    ```go
    package fedex
    
    import "fmt"
    
    type FedexSender struct {
    	// ...
    }
    
    func (f *FedexSender) Send(parcel string) {
    	fmt.Printf("Fedex sends %s parcel\n", parcel)
    }
    ```
    
    ```powershell
    yoonhee@Yoonhee ch20 % go mod init goprojects/ch20
    go: creating new go.mod: module goprojects/ch20
    go: to add module requirements and sums:
            go mod tidy
    ```
    
- ex20.2 λ””λ ‰ν† λ¦¬ λ§λ“¤κ³  ex20.2.go μ‘μ„±
    
    ```go
    package main
    
    import "goprojects/ch20/fedex"
    
    func SendBook(name string, sender *fedex.FedexSender) {
    	sender.Send(name)
    }
    
    func main() {
    	sender := &fedex.FedexSender{}
    	SendBook("μ–΄λ¦° μ™•μ", sender)
    	SendBook("κ·Έλ¦¬μ¤μΈ μ΅°λ¥΄λ°”", sender)
    }
    ```
    
    ```powershell
    yoonhee@Yoonhee ch20 % cd ex20.2
    yoonhee@Yoonhee ex20.2 % go build
    yoonhee@Yoonhee ex20.2 % ./ex20.2 
    Fedex sends μ–΄λ¦° μ™•μ parcel
    Fedex sends κ·Έλ¦¬μ¤μΈ μ΅°λ¥΄λ°” parcel
    ```
    
- κ°‘μκΈ° λ” μ‹Ό μ°μ²΄κµ­ νƒλ°°κ°€ μƒκ²Όλ‹¤κ³  ν•μ. koreaPost λ””λ ‰ν† λ¦¬ λ§λ“¤κ³  post.go μ‘μ„±
    
    ```go
    package koreapost
    
    import "fmt"
    
    type PostSender struct {
    	// ...
    }
    
    func (k *PostSender) Send(parcel string) {
    	fmt.Printf("μ°μ²΄κµ­μ—μ„ νƒλ°° %sλ¥Ό λ³΄λƒ…λ‹λ‹¤.\n", parcel)
    }
    ```
    
- ex20.2.go λ³€κ²½
    
    ```go
    package main
    
    import (
    	koreapost "goprojects/ch20/koreaPost"
    )
    
    // func SendBook(name string, sender *fedex.FedexSender) {
    // 	sender.Send(name)
    // }
    
    func SendBook(name string, sender *koreapost.PostSender) {
    	sender.Send(name)
    }
    
    func main() {
    	// sender := &fedex.FedexSender{}
    	sender := &koreapost.PostSender{}
    	SendBook("μ–΄λ¦° μ™•μ", sender)
    	SendBook("κ·Έλ¦¬μ¤μΈ μ΅°λ¥΄λ°”", sender)
    }
    ```
    
- μ‹¤ν–‰
    
    ```powershell
    yoonhee@Yoonhee ex20.2 % ./ex20.2
    μ°μ²΄κµ­μ—μ„ νƒλ°° μ–΄λ¦° μ™•μλ¥Ό λ³΄λƒ…λ‹λ‹¤.
    μ°μ²΄κµ­μ—μ„ νƒλ°° κ·Έλ¦¬μ¤μΈ μ΅°λ¥΄λ°”λ¥Ό λ³΄λƒ…λ‹λ‹¤.
    ```
    
    β†’ μ‚°νƒ„μ΄ μ½”λ“: μ‚¬μ©ν•λ” λ¶€λ¶„μ„ μ „λ¶€ λ‹¤ λ°”κΏ”μ¤μ•Ό ν•λ” μ½”λ“
    

π‘‰ μΈν„°νμ΄μ¤ λ°©μ‹μΌλ΅ λ°”κΎΈμ

- ex20.2.go λ³€κ²½
    
    ```go
    package main
    
    import (
    	"goprojects/ch20/fedex"
    	"goprojects/ch20/koreapost"
    )
    
    // func SendBook(name string, sender *fedex.FedexSender) {
    // 	sender.Send(name)
    // }
    
    type Sender interface {
    	Send(parcel string)
    }
    
    // func SendBook(name string, sender *koreapost.PostSender) {
    // 	sender.Send(name)
    // }
    
    func SendBook(name string, sender Sender) {
    	sender.Send(name)
    }
    
    func main() {
    	sender1 := &fedex.FedexSender{}
    	sender2 := &koreapost.PostSender{}
    
    	SendBook("μ–΄λ¦° μ™•μ", sender1)
    	SendBook("κ·Έλ¦¬μ¤μΈ μ΅°λ¥΄λ°”", sender1)
    
    	SendBook("μ–΄λ¦° μ™•μ", sender2)
    	SendBook("κ·Έλ¦¬μ¤μΈ μ΅°λ¥΄λ°”", sender2)
    }
    ```
    
- μ‹¤ν–‰
    
    ```powershell
    yoonhee@Yoonhee ex20.2 % ./ex20.2 
    Fedex sends μ–΄λ¦° μ™•μ parcel
    Fedex sends κ·Έλ¦¬μ¤μΈ μ΅°λ¥΄λ°” parcel
    μ°μ²΄κµ­μ—μ„ νƒλ°° μ–΄λ¦° μ™•μλ¥Ό λ³΄λƒ…λ‹λ‹¤.
    μ°μ²΄κµ­μ—μ„ νƒλ°° κ·Έλ¦¬μ¤μΈ μ΅°λ¥΄λ°”λ¥Ό λ³΄λƒ…λ‹λ‹¤.
    ```
    

## μ¶”μƒν™”λ€?

---

- λ‚΄λ¶€ λ™μ‘μ„ κ°μ¶°μ„ μ„λΉ„μ¤ μ κ³µμμ™€ μ‚¬μ©μ λ¨λ‘μ—κ² μμ λ¥Ό μ£Όλ” λ°©μ‹μ„ μ¶”μƒν™”(Abstraction)λΌκ³  ν•©λ‹λ‹¤.
    - νƒλ°°λ¥Ό λ³΄λ‚Ό λ• Fedexλ΅ λ³΄λ‚΄λ“ , μ°μ²΄κµ­μΌλ΅ λ³΄λ‚΄λ“  λ‚΄λ¶€ λ°μ†΅ κ³Όμ •μ„ μμ„Έν λ°λΌλ„ λ³΄λ‚Ό μ μλ“―μ΄ μ¶”μƒν™”λ¥Ό ν•λ©΄ μμ΅΄μ„±μ„ λμ„ μ μμµλ‹λ‹¤.

### μ¶”μƒ κ³„μΈµ

---

![Untitled](./image/20/Untitled%203.png)

## λ•νƒ€μ΄ν•‘

---

- λ§μ•½ μ–΄λ–¤ μƒλ¥Ό λ΄¤λ”λ° κ·Έ μƒκ°€ μ¤λ¦¬μ²λΌ κ±·κ³  μ¤λ¦¬μ²λΌ λ‚ κ³  μ¤λ¦¬μ²λΌ μ†λ¦¬λ‚΄λ©΄
    - λ‚λ” κ·Έ μƒλ¥Ό μ¤λ¦¬λΌκ³  λ¶€λ¥΄κ² λ‹¤.
- μλ°”, νμ΄μ¬μ€ μ κ³µν•μ§€ μ•λ” λ°©μ‹
    - `implements xx` μ•ν•΄λ„ λλ‹¤.

![Untitled](./image/20/Untitled%204.png)

- μΈν„°νμ΄μ¤ κµ¬ν„ μ—¬λ¶€λ¥Ό νƒ€μ… μ„ μ–Έ μ‹ ν•λ”κ² μ•„λ‹λΌ μΈν„°νμ΄μ¤μ— λ€μ…μ„ ν•  λ•(μ»΄νμΌ νƒ€μ„)μ— μ²΄ν¬ν•λ‹¤.
    - λ°νƒ€μ„ μ²΄ν¬κ°€ μ•„λ‹λΌμ„ μ‹¤ν–‰μ¤‘μ— μ„±λ¥μ„ μ“°μ§„ μ•λ”λ‹¤.

### μ‚¬μ©μ μ¤‘μ‹¬μ μ½”λ”©

---

- μΈν„°νμ΄μ¤ κµ¬ν„ μ—¬λ¶€λ¥Ό νƒ€μ… μ„ μ–Έμ‹ ν•μ§€ μ•κ³ , μΈν„°νμ΄μ¤κ°€ μ‚¬μ©λ  λ• κ²°μ •ν•κΈ° λ•λ¬Έμ— μ„λΉ„μ¤ μ κ³µμλ” κµ¬μ²΄ν™”λ κ°μ²΄λ¥Ό μ κ³µν•κ³  μ‚¬μ©μκ°€ ν•„μ”μ— λ”°λΌ μΈν„°νμ΄μ¤λ¥Ό μ •μν•΄μ„ μ‚¬μ©ν•  μ μλ‹¤.

![Untitled](./image/20/Untitled%205.png)

## μΈν„°νμ΄μ¤ μ‚¬μ΄μ¦

---

![Untitled](./image/20/Untitled%206.png)

- μΈν„°νμ΄μ¤κ°€ κ°€λ¦¬ν‚¤κ³  μλ” μΈμ¤ν„΄μ¤μ λ©”λ¨λ¦¬ μ£Όμ†
- μ–΄λ–¤ νƒ€μ…μ„ κ°€λ¦¬ν‚¤λ“ , 16λ°”μ΄νΈλ‹¤.

## μΈν„°νμ΄μ¤ κΈ°λ¥ λ” μ•κΈ°

---

### ν¬ν•¨λ μΈν„°νμ΄μ¤

---

![Untitled](./image/20/Untitled%207.png)

### λΉ μΈν„°νμ΄μ¤

---

![Untitled](./image/20/Untitled%208.png)

- λ¨λ“  νƒ€μ…μ΄ λ¨λ‘ κ°€λ¥ν•λ‹¤.

- ex20.5.go
    
    ```go
    package main
    
    import "fmt"
    
    func PrintVal(v interface{}) { // λΉ μΈν„°νμ΄μ¤λ¥Ό μΈμλ΅ λ°›λ” ν•¨μ
    	switch t := v.(type) {
    	case int:
    		fmt.Printf("v is int %d\n", int(t))
    	case float64:
    		fmt.Printf("v is float64 %f\n", float64(t))
    	case string:
    		fmt.Printf("v is string %s\n", string(t))
    	default:
    		// κ·Έμ™Έ νƒ€μ…μΈ κ²½μ° νƒ€μ…κ³Ό κ°’μ„ μ¶λ ¥ν•©λ‹λ‹¤.
    		fmt.Printf("Not supported type: %T:%v\n", t, t)
    	}
    }
    
    type Student struct {
    	Age int
    }
    
    func main() {
    	PrintVal(10)          // int
    	PrintVal(3.14)        // float64
    	PrintVal("Hello")     // string
    	PrintVal(Student{15}) // Student
    }
    ```
    
- μ‹¤ν–‰
    
    ```powershell
    yoonhee@Yoonhee ex20.5 % ./ex20.5
    v is int 10
    v is float64 3.140000
    v is string Hello
    Not supported type: main.Student:{15}
    ```
    

### μΈν„°νμ΄μ¤ κΈ°λ³Έκ°’

---

- `nil`

- ex20.6.go
    
    ```go
    // ch20/ex20.6/ex20.6.go
    package main
    
    type Attacker interface {
    	Attack()
    }
    
    func main() {
    	var att Attacker // κΈ°λ³Έκ°’μ€ nilμ…λ‹λ‹¤.
    	att.Attack()     // attκ°€ nilμ΄κΈ° λ•λ¬Έμ— λ°νƒ€μ„ μ—λ¬κ°€ λ°μƒν•©λ‹λ‹¤.
    }
    ```
    
- μ‹¤ν–‰
    
    ```powershell
    yoonhee@Yoonhee ex20.6 % ./ex20.6
    panic: runtime error: invalid memory address or nil pointer dereference
    [signal SIGSEGV: segmentation violation code=0x2 addr=0x0 pc=0x1045148cc]
    
    goroutine 1 [running]:
    main.main()
            /Users/yoonhee/kyh1126/goprojects/ex20.6/ex20.6.go:10 +0x1c
    ```
    

### μΈν„°νμ΄μ¤ νƒ€μ… λ³€ν™

---

![Untitled](./image/20/Untitled%209.png)

- ex20.7.go
    
    ```go
    package main
    
    import "fmt"
    
    type Stringer interface {
    	String() string
    }
    
    type Student struct {
    	Age int
    }
    
    func (s *Student) String() string {
    	return fmt.Sprintf("Student Age:%d", s.Age)
    }
    
    func PrintAge(stringer Stringer) {
    
    	s := stringer.(*Student)       // *Student νƒ€μ…μΌλ΅ νƒ€μ… λ³€ν™
    	fmt.Printf("Age: %d\n", s.Age)
    
    }
    
    func main() {
    	s := &Student{15} // *Student νƒ€μ… λ³€μ s μ„ μ–Έ λ° μ΄κΈ°ν™”
    
    	PrintAge(s) // λ³€μ s λ¥Ό μΈν„°νμ΄μ¤ μΈμλ΅ PrintAge() ν•¨μ νΈμ¶
    }
    ```
    
- μ‹¤ν–‰
    
    ```powershell
    yoonhee@Yoonhee ex20.7 % ./ex20.7
    Age: 15
    ```
    
    - νƒ€μ… λ³€ν™ μ‹ μ•λ§μΌλ©΄ `panic` λ°νƒ€μ„ μ—λ¬κ°€ λ‚λ‹¤.

### μΈν„°νμ΄μ¤ λ³€ν™μ‹ μ»΄νμΌ μ—λ¬

---

- ex20.8
    
    ```go
    package main
    
    type Stringer interface {
    	String() string
    }
    
    type Student struct {
    }
    
    func main() {
    	var stringer Stringer
    	stringer.(*Student) // λΉλ“ νƒ€μ„ μ—λ¬ λ°μƒ. impossible type assertion: stringer.(*Student)
    	// *Student does not implement Stringer (missing method String) compiler-ImpossibleAssert
    }
    ```
    
    - κ·Έ νƒ€μ…μΌλ΅ μΈν„°νμ΄μ¤ μ‚¬μ© μμ²΄κ°€ λ¶κ°€λ¥ν•λ©΄ `panic` μ»΄νμΌ μ—λ¬κ°€ λ‚λ‹¤.

### λ‹¤λ¥Έ μΈν„°νμ΄μ¤ νƒ€μ…μΌλ΅ λ³€ν™

---

- ex20.10
    
    ```go
    package main
    
    type Reader interface {
    	Read()
    }
    
    type Closer interface {
    	Close()
    }
    
    type File struct {
    }
    
    func (f *File) Read() {
    }
    
    func ReadFile(reader Reader) {
    	// Reader μΈν„°νμ΄μ¤ λ³€μλ¥Ό Closer μΈν„°νμ΄μ¤λ΅ νƒ€μ… λ³€ν™ν•©λ‹λ‹¤. λ°νƒ€μ„ μ—λ¬ λ°μƒ
    	c := reader.(Closer)
    	c.Close()
    }
    
    func main() {
    	// File ν¬μΈν„° μΈμ¤ν„΄μ¤λ¥Ό ReadFile() ν•¨μμ μΈμλ΅ μ‚¬μ©ν•©λ‹λ‹¤.
    	file := &File{}
    	ReadFile(file)
    }
    ```
    
- μ‹¤ν–‰
    
    ```powershell
    yoonhee@Yoonhee ex20.10 % ./ex20.10
    panic: interface conversion: *main.File is not main.Closer: missing method Close
    
    goroutine 1 [running]:
    main.ReadFile(...)
            /Users/yoonhee/kyh1126/goprojects/ex20.10/ex20.10.go:20
    main.main()
            /Users/yoonhee/kyh1126/goprojects/ex20.10/ex20.10.go:27 +0x64
    ```
    
    - `panic` λ°νƒ€μ„ μ—λ¬ λ°μƒ
- Closer μΈν„°νμ΄μ¤ κµ¬ν„ν•λ©΄ λ³€ν™ κ°€λ¥ν•΄μ§„λ‹¤. μ•„λ μ¶”κ°€ μ‹ μ„±κ³µ
    
    ```go
    func (f *File) Close() {
    	fmt.Println("Close()")
    }
    ```
    
    ```powershell
    yoonhee@Yoonhee ex20.10 % ./ex20.10
    Close()
    ```
    

### νƒ€μ… λ³€ν™ μ„±κ³µ μ—¬λ¶€ λ°ν™

---

![Untitled](./image/20/Untitled%2010.png)

- ex20.10.go - κ°μ„  λ²„μ „ (μ„±κ³µ)
    
    ```go
    package main
    
    import "fmt"
    
    type Reader interface {
    	Read()
    }
    
    type Closer interface {
    	Close()
    }
    
    type File struct {
    }
    
    func (f *File) Read() {
    }
    
    func (f *File) Close() {
    	fmt.Println("Close()")
    }
    
    func ReadFile(reader Reader) {
    	// Reader μΈν„°νμ΄μ¤ λ³€μλ¥Ό Closer μΈν„°νμ΄μ¤λ΅ νƒ€μ… λ³€ν™ν•©λ‹λ‹¤.
    	// λ°νƒ€μ„ μ—λ¬κ°€ λ°μƒν•©λ‹λ‹¤.
    	c, ok := reader.(Closer)
    	fmt.Println(c, ok)
    
    	if ok {
    		c.Close()
    	}
    }
    
    func main() {
    	// File ν¬μΈν„° μΈμ¤ν„΄μ¤λ¥Ό ReadFile() ν•¨μμ μΈμλ΅ μ‚¬μ©ν•©λ‹λ‹¤.
    	file := &File{}
    	ReadFile(file)
    }
    ```
    
    ```powershell
    yoonhee@Yoonhee ex20.10 % ./ex20.10
    &{} true
    Close()
    ```
    
- ex20.10.go - κ°μ„  λ²„μ „ (μ‹¤ν¨)
    
    ```go
    package main
    
    import "fmt"
    
    type Reader interface {
    	Read()
    }
    
    type Closer interface {
    	Close()
    }
    
    type File struct {
    }
    
    func (f *File) Read() {
    }
    
    func ReadFile(reader Reader) {
    	// Reader μΈν„°νμ΄μ¤ λ³€μλ¥Ό Closer μΈν„°νμ΄μ¤λ΅ νƒ€μ… λ³€ν™ν•©λ‹λ‹¤.
    	// λ°νƒ€μ„ μ—λ¬κ°€ λ°μƒν•©λ‹λ‹¤.
    	c, ok := reader.(Closer)
    	fmt.Println(c, ok)
    
    	if ok {
    		c.Close()
    	}
    }
    
    func main() {
    	// File ν¬μΈν„° μΈμ¤ν„΄μ¤λ¥Ό ReadFile() ν•¨μμ μΈμλ΅ μ‚¬μ©ν•©λ‹λ‹¤.
    	file := &File{}
    	ReadFile(file)
    }
    ```
    
    ```powershell
    yoonhee@Yoonhee ex20.10 % ./ex20.10
    <nil> false
    ```
    

### κ΄€μ© ν‘ν„

---

![Untitled](./image/20/Untitled%2011.png)

- ex20.10.go - κ°μ„  λ²„μ „ (μ„±κ³µ)
    
    ```go
    package main
    
    import "fmt"
    
    type Reader interface {
    	Read()
    }
    
    type Closer interface {
    	Close()
    }
    
    type File struct {
    }
    
    func (f *File) Read() {
    }
    
    func (f *File) Close() {
    	fmt.Println("Close()")
    }
    
    //	func ReadFile(reader Reader) {
    //		// Reader μΈν„°νμ΄μ¤ λ³€μλ¥Ό Closer μΈν„°νμ΄μ¤λ΅ νƒ€μ… λ³€ν™ν•©λ‹λ‹¤.
    //		// λ°νƒ€μ„ μ—λ¬κ°€ λ°μƒν•©λ‹λ‹¤.
    //		c := reader.(Closer)
    //		c.Close()
    //	}
    func ReadFile(reader Reader) {
    	// Reader μΈν„°νμ΄μ¤ λ³€μλ¥Ό Closer μΈν„°νμ΄μ¤λ΅ νƒ€μ… λ³€ν™ν•©λ‹λ‹¤.
    	// λ°νƒ€μ„ μ—λ¬κ°€ λ°μƒν•©λ‹λ‹¤.
    
    	if c, ok := reader.(Closer); ok {
    		c.Close()
    	}
    }
    
    func main() {
    	// File ν¬μΈν„° μΈμ¤ν„΄μ¤λ¥Ό ReadFile() ν•¨μμ μΈμλ΅ μ‚¬μ©ν•©λ‹λ‹¤.
    	file := &File{}
    	ReadFile(file)
    }
    ```
    
    ```powershell
    yoonhee@Yoonhee ex20.10 % ./ex20.10
    Close()
    ```
