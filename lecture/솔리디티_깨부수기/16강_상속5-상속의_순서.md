# 16ê°•. ìƒì† 5 - ìƒì†ì˜ ìˆœì„œ

## C3 Linearization

---

- ìƒì† ê³„ì¸µ ì „ì²´ë¥¼ ì„ í˜•(Linear) êµ¬ì¡°ë¡œ ì •ë ¬í•œ ë‹¤ìŒ, `super`ëŠ” ê·¸ ì„ í˜• êµ¬ì¡°ë¥¼ ë”°ë¼ ë‹¤ìŒì— ìœ„ì¹˜í•œ ë¶€ëª¨ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œë‹¤.
    - SolidityëŠ” `override` í•´ì„ ì‹œ ì˜¤ë¥¸ìª½ ë¶€ëª¨ì—ê²Œ ìš°ì„ ìˆœìœ„ë¥¼ ì¤€ë‹¤.
- SolidityëŠ” ë‹¤ì¤‘ ìƒì†ì—ì„œ `super`ë¥¼ í˜¸ì¶œí•  ë•Œ, ìƒì† ìˆœì„œì— ë”°ë¼ ë©”ì„œë“œ í˜¸ì¶œ ìš°ì„ ìˆœìœ„ë¥¼ ì •í•´ë†“ëŠ” MRO(ë©”ì„œë“œ í•´ì„ ìˆœì„œ)ë¥¼ ë”°ë¥¸ë‹¤.
    
    ```solidity
    // SPDX-License-Identifier:GPL-30
    pragma solidity >= 0.7.0 < 0.9.0;
    
    contract Father {
        event FatherName(string name);
        function who() public virtual{
            emit FatherName("KimDaeho");
        }
    }
    
    contract Mother {
        event MotherName(string name);
        function who() public virtual{
            emit MotherName("leeSol");
        }
    }
    
    contract Son is Father, Mother {
        function who() public override(Father,Mother){
            super.who();
        }
    }
    ```
    
    - ì„ ì–¸ìƒ ìƒì† ìˆœì„œ: Son â†’ Father â†’ Mother
    - ì‹¤ì œ ì‹¤í–‰ ìˆœì„œ: Son â†’ Mother â†’ Father

ðŸ¤”

- Solidityê°€ `Son is Father, Mother`ì²˜ëŸ¼ ë‹¤ì¤‘ ìƒì†ì„ ì²˜ë¦¬í•  ë•Œ, í•˜ìœ„ í´ëž˜ìŠ¤ì˜ ìˆœì„œë¥¼ ë³´ì¡´í•˜ë©´ì„œ, ì¤‘ë³µ ì—†ì´ ê°€ëŠ¥í•œ ëª¨ë“  ë¶€ëª¨ë¥¼ ë¨¼ì € ì†Œë¹„í•˜ëŠ” êµ¬ì¡°ë¡œ ì„ í˜•í™”í•œë‹¤.

> ê°€ëŠ¥í•œ í›„ë³´ë“¤ ì¤‘ ê°€ìž¥ ì•žì— ìžˆëŠ” í•­ëª© ì¤‘ì—ì„œ, ë‹¤ë¥¸ ë¦¬ìŠ¤íŠ¸ì˜ ê¼¬ë¦¬(í›„ì†)ì— ì—†ëŠ” í•­ëª©ì„ ê³ ë¥¸ë‹¤.
> 

## ì˜ˆì œ

---

- lec15.sol
    
    ```solidity
    // SPDX-License-Identifier:GPL-30
    pragma solidity >= 0.7.0 < 0.9.0;
    
    contract Father {
        event FatherName(string name);
        function who() public virtual{
            emit FatherName("KimDaeho");
        }
    }
    
    contract Mother {
        event MotherName(string name);
        function who() public virtual{
            emit MotherName("leeSol");
        }
    }
    
    contract Son is Father, Mother{
        event sonName(string name);
        function who() public override(Mother, Father) {
            super.who();
            emit sonName("KimJin");
        }
    }
    ```
    
- ì‹¤í–‰
    - Son ì»¨íŠ¸ëž™íŠ¸ ë°°í¬
    - Mother â†’ Son ìˆœì„œë¡œ ë¡œê·¸ê°€ `emit`ëœë‹¤.
        
        ![image.png](./image/16/image.png)
        
        1. ê° í´ëž˜ìŠ¤ì˜ Linearization ì •ì˜
            
            Father: [Father]
            Mother: [Mother]
            Son: [Son] + merge(L(Mother), L(Father), [Mother, Father])
            
        2. `merge(Father, Mother)`
            - C3ëŠ” "ê°€ëŠ¥í•œ ë¶€ëª¨ë“¤ ì¤‘ì—ì„œ ì²« ë²ˆì§¸ í›„ë³´ë¥¼ ì„ íƒí•˜ê³ , ê·¸ í›„ë³´ê°€ ë‚˜ë¨¸ì§€ ëª¨ë“  í›„ë³´ë“¤ì˜ ê¼¬ë¦¬ ë¶€ë¶„(ë’¤ìª½)ì— ì—†ëŠ” ê²½ìš°ì—ë§Œ ì„ íƒ"í•œë‹¤.
            
            â†’ ìµœì¢… Linearization: [Son, Mother, Father]
            

- lec16.sol
    
    ```solidity
    // SPDX-License-Identifier:GPL-30
    pragma solidity >= 0.7.0 < 0.9.0;
    
    contract A {
        event Log(string who);
        function who() public virtual {
            emit Log("A");
        }
    }
    
    contract B is A {
        function who() public virtual override {
            emit Log("B");
            super.who();
        }
    }
    
    contract C is A {
        function who() public virtual override {
            emit Log("C");
            super.who();
        }
    }
    
    contract D is B, C {
        function who() public virtual override(B, C) {
            emit Log("D");
            super.who();
        }
    }
    
    contract E is D {
        function who() public override {
            emit Log("E");
            super.who();
        }
    }
    ```
    
- ì‹¤í–‰
    - E ì»¨íŠ¸ëž™íŠ¸ ë°°í¬
    - ë¡œê·¸ ìˆœì„œ ë•Œë¬¸ì— ì½˜ì†”ì—” E D C B Aë¡œ ì°ížŒë‹¤.
        
        ![image.png](./image/16/image%201.png)
        
        ![image.png](./image/16/image%202.png)
        
        ```solidity
              A
             / \
            B   C
             \ /
              D
               \
                E
        ```
        
        1. ë¨¼ì € ê° ì»¨íŠ¸ëž™íŠ¸ì˜ Linearizationì„ ì •ì˜
            - `A`: [A]
            - `B is A`: [B, A]
            - `C is A`: [C, A]
            - `D is B, C`: [D] + `merge(L(C), L(B), [C, B])`
        2. `merge(L(B), L(C), [C, B])` = `merge([B, A], [C, A], [C, B])`
            - í›„ë³´: [B, A], [C, A], [C, B]
                - BëŠ” ë‹¤ë¥¸ ë¦¬ìŠ¤íŠ¸ë“¤([C, A], [C, B])ì˜ ê¼¬ë¦¬ì— ìžˆìœ¼ë¯€ë¡œ ì„ íƒ ë¶ˆê°€ëŠ¥
                - CëŠ” ë‹¤ë¥¸ ë¦¬ìŠ¤íŠ¸ë“¤([B, A], [C, B])ì˜ ê¼¬ë¦¬ì— ì—†ìœ¼ë¯€ë¡œ ì„ íƒ ê°€ëŠ¥
            - í›„ë³´: [B, A], [A], [B]
                - B ì„ íƒ
            - í›„ë³´: [A], [A]
                - 3ë²ˆì§¸ ì„ íƒ: A
            
            â†’ ìµœì¢… Linearization: L(D) = [D, C, B, A]
            
            - L(E) = [E] + L(D) = [E, D, C, B, A]
